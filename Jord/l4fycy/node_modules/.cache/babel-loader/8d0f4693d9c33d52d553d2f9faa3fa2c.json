{"ast":null,"code":"import _classCallCheck from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\nimport { Pass, FullScreenQuad } from './Pass.js';\nimport { WebGLRenderTarget, NearestFilter, MeshDepthMaterial, RGBADepthPacking, NoBlending, UniformsUtils, ShaderMaterial, Color } from 'three';\nimport { BokehShader } from '../shaders/BokehShader.js';\n\nvar BokehPass = /*#__PURE__*/function (_Pass) {\n  _inherits(BokehPass, _Pass);\n\n  var _super = _createSuper(BokehPass);\n\n  function BokehPass(scene, camera, params) {\n    var _this;\n\n    _classCallCheck(this, BokehPass);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"scene\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"camera\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"renderTargetDepth\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"materialDepth\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"materialBokeh\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"fsQuad\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_oldClearColor\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"uniforms\", void 0);\n\n    _this.scene = scene;\n    _this.camera = camera;\n    var focus = params.focus !== undefined ? params.focus : 1.0;\n    var aspect = params.aspect !== undefined ? params.aspect : camera.aspect;\n    var aperture = params.aperture !== undefined ? params.aperture : 0.025;\n    var maxblur = params.maxblur !== undefined ? params.maxblur : 1.0; // render targets\n\n    var width = params.width || window.innerWidth || 1;\n    var height = params.height || window.innerHeight || 1;\n    _this.renderTargetDepth = new WebGLRenderTarget(width, height, {\n      minFilter: NearestFilter,\n      magFilter: NearestFilter\n    });\n    _this.renderTargetDepth.texture.name = 'BokehPass.depth'; // depth material\n\n    _this.materialDepth = new MeshDepthMaterial();\n    _this.materialDepth.depthPacking = RGBADepthPacking;\n    _this.materialDepth.blending = NoBlending; // bokeh material\n\n    if (BokehShader === undefined) {\n      console.error('BokehPass relies on BokehShader');\n    }\n\n    var bokehShader = BokehShader;\n    var bokehUniforms = UniformsUtils.clone(bokehShader.uniforms);\n    bokehUniforms['tDepth'].value = _this.renderTargetDepth.texture;\n    bokehUniforms['focus'].value = focus;\n    bokehUniforms['aspect'].value = aspect;\n    bokehUniforms['aperture'].value = aperture;\n    bokehUniforms['maxblur'].value = maxblur;\n    bokehUniforms['nearClip'].value = camera.near;\n    bokehUniforms['farClip'].value = camera.far;\n    _this.materialBokeh = new ShaderMaterial({\n      defines: Object.assign({}, bokehShader.defines),\n      uniforms: bokehUniforms,\n      vertexShader: bokehShader.vertexShader,\n      fragmentShader: bokehShader.fragmentShader\n    });\n    _this.uniforms = bokehUniforms;\n    _this.needsSwap = false;\n    _this.fsQuad = new FullScreenQuad(_this.materialBokeh);\n    _this._oldClearColor = new Color();\n    return _this;\n  }\n\n  _createClass(BokehPass, [{\n    key: \"render\",\n    value: function render(renderer, writeBuffer, readBuffer\n    /*, deltaTime, maskActive */\n    ) {\n      // Render depth into texture\n      this.scene.overrideMaterial = this.materialDepth;\n      renderer.getClearColor(this._oldClearColor);\n      var oldClearAlpha = renderer.getClearAlpha();\n      var oldAutoClear = renderer.autoClear;\n      renderer.autoClear = false;\n      renderer.setClearColor(0xffffff);\n      renderer.setClearAlpha(1.0);\n      renderer.setRenderTarget(this.renderTargetDepth);\n      renderer.clear();\n      renderer.render(this.scene, this.camera); // Render bokeh composite\n\n      this.uniforms['tColor'].value = readBuffer.texture;\n      this.uniforms['nearClip'].value = this.camera.near;\n      this.uniforms['farClip'].value = this.camera.far;\n\n      if (this.renderToScreen) {\n        renderer.setRenderTarget(null);\n        this.fsQuad.render(renderer);\n      } else {\n        renderer.setRenderTarget(writeBuffer);\n        renderer.clear();\n        this.fsQuad.render(renderer);\n      }\n\n      this.scene.overrideMaterial = null;\n      renderer.setClearColor(this._oldClearColor);\n      renderer.setClearAlpha(oldClearAlpha);\n      renderer.autoClear = oldAutoClear;\n    }\n  }]);\n\n  return BokehPass;\n}(Pass);\n\nexport { BokehPass };","map":{"version":3,"names":["_defineProperty","Pass","FullScreenQuad","WebGLRenderTarget","NearestFilter","MeshDepthMaterial","RGBADepthPacking","NoBlending","UniformsUtils","ShaderMaterial","Color","BokehShader","BokehPass","scene","camera","params","focus","undefined","aspect","aperture","maxblur","width","window","innerWidth","height","innerHeight","renderTargetDepth","minFilter","magFilter","texture","name","materialDepth","depthPacking","blending","console","error","bokehShader","bokehUniforms","clone","uniforms","value","near","far","materialBokeh","defines","Object","assign","vertexShader","fragmentShader","needsSwap","fsQuad","_oldClearColor","renderer","writeBuffer","readBuffer","overrideMaterial","getClearColor","oldClearAlpha","getClearAlpha","oldAutoClear","autoClear","setClearColor","setClearAlpha","setRenderTarget","clear","render","renderToScreen"],"sources":["D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/three-stdlib/postprocessing/BokehPass.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\r\nimport { Pass, FullScreenQuad } from './Pass.js';\r\nimport { WebGLRenderTarget, NearestFilter, MeshDepthMaterial, RGBADepthPacking, NoBlending, UniformsUtils, ShaderMaterial, Color } from 'three';\r\nimport { BokehShader } from '../shaders/BokehShader.js';\r\n\r\nclass BokehPass extends Pass {\r\n  constructor(scene, camera, params) {\r\n    super();\r\n\r\n    _defineProperty(this, \"scene\", void 0);\r\n\r\n    _defineProperty(this, \"camera\", void 0);\r\n\r\n    _defineProperty(this, \"renderTargetDepth\", void 0);\r\n\r\n    _defineProperty(this, \"materialDepth\", void 0);\r\n\r\n    _defineProperty(this, \"materialBokeh\", void 0);\r\n\r\n    _defineProperty(this, \"fsQuad\", void 0);\r\n\r\n    _defineProperty(this, \"_oldClearColor\", void 0);\r\n\r\n    _defineProperty(this, \"uniforms\", void 0);\r\n\r\n    this.scene = scene;\r\n    this.camera = camera;\r\n    const focus = params.focus !== undefined ? params.focus : 1.0;\r\n    const aspect = params.aspect !== undefined ? params.aspect : camera.aspect;\r\n    const aperture = params.aperture !== undefined ? params.aperture : 0.025;\r\n    const maxblur = params.maxblur !== undefined ? params.maxblur : 1.0; // render targets\r\n\r\n    const width = params.width || window.innerWidth || 1;\r\n    const height = params.height || window.innerHeight || 1;\r\n    this.renderTargetDepth = new WebGLRenderTarget(width, height, {\r\n      minFilter: NearestFilter,\r\n      magFilter: NearestFilter\r\n    });\r\n    this.renderTargetDepth.texture.name = 'BokehPass.depth'; // depth material\r\n\r\n    this.materialDepth = new MeshDepthMaterial();\r\n    this.materialDepth.depthPacking = RGBADepthPacking;\r\n    this.materialDepth.blending = NoBlending; // bokeh material\r\n\r\n    if (BokehShader === undefined) {\r\n      console.error('BokehPass relies on BokehShader');\r\n    }\r\n\r\n    const bokehShader = BokehShader;\r\n    const bokehUniforms = UniformsUtils.clone(bokehShader.uniforms);\r\n    bokehUniforms['tDepth'].value = this.renderTargetDepth.texture;\r\n    bokehUniforms['focus'].value = focus;\r\n    bokehUniforms['aspect'].value = aspect;\r\n    bokehUniforms['aperture'].value = aperture;\r\n    bokehUniforms['maxblur'].value = maxblur;\r\n    bokehUniforms['nearClip'].value = camera.near;\r\n    bokehUniforms['farClip'].value = camera.far;\r\n    this.materialBokeh = new ShaderMaterial({\r\n      defines: Object.assign({}, bokehShader.defines),\r\n      uniforms: bokehUniforms,\r\n      vertexShader: bokehShader.vertexShader,\r\n      fragmentShader: bokehShader.fragmentShader\r\n    });\r\n    this.uniforms = bokehUniforms;\r\n    this.needsSwap = false;\r\n    this.fsQuad = new FullScreenQuad(this.materialBokeh);\r\n    this._oldClearColor = new Color();\r\n  }\r\n\r\n  render(renderer, writeBuffer, readBuffer\r\n  /*, deltaTime, maskActive */\r\n  ) {\r\n    // Render depth into texture\r\n    this.scene.overrideMaterial = this.materialDepth;\r\n    renderer.getClearColor(this._oldClearColor);\r\n    const oldClearAlpha = renderer.getClearAlpha();\r\n    const oldAutoClear = renderer.autoClear;\r\n    renderer.autoClear = false;\r\n    renderer.setClearColor(0xffffff);\r\n    renderer.setClearAlpha(1.0);\r\n    renderer.setRenderTarget(this.renderTargetDepth);\r\n    renderer.clear();\r\n    renderer.render(this.scene, this.camera); // Render bokeh composite\r\n\r\n    this.uniforms['tColor'].value = readBuffer.texture;\r\n    this.uniforms['nearClip'].value = this.camera.near;\r\n    this.uniforms['farClip'].value = this.camera.far;\r\n\r\n    if (this.renderToScreen) {\r\n      renderer.setRenderTarget(null);\r\n      this.fsQuad.render(renderer);\r\n    } else {\r\n      renderer.setRenderTarget(writeBuffer);\r\n      renderer.clear();\r\n      this.fsQuad.render(renderer);\r\n    }\r\n\r\n    this.scene.overrideMaterial = null;\r\n    renderer.setClearColor(this._oldClearColor);\r\n    renderer.setClearAlpha(oldClearAlpha);\r\n    renderer.autoClear = oldAutoClear;\r\n  }\r\n\r\n}\r\n\r\nexport { BokehPass };\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}