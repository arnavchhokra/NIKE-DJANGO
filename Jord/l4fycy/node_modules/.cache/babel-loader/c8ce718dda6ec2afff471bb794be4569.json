{"ast":null,"code":"import _slicedToArray from \"D:/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectWithoutProperties from \"D:/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nvar _excluded = [\"mixBlur\", \"mixStrength\", \"resolution\", \"blur\", \"minDepthThreshold\", \"maxDepthThreshold\", \"depthScale\", \"depthToBlurRatioBias\", \"mirror\", \"distortion\", \"mixContrast\", \"distortionMap\", \"reflectorOffset\"];\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport { Plane, Vector3, Matrix4, Vector4, PerspectiveCamera, LinearFilter, HalfFloatType, WebGLRenderTarget, DepthTexture, DepthFormat, UnsignedShortType } from 'three';\nimport { extend, useThree, useFrame } from '@react-three/fiber';\nimport mergeRefs from 'react-merge-refs';\nimport { BlurPass } from '../materials/BlurPass.js';\nimport { MeshReflectorMaterial as MeshReflectorMaterial$1 } from '../materials/MeshReflectorMaterial.js';\nextend({\n  MeshReflectorMaterialImpl: MeshReflectorMaterial$1\n});\nvar MeshReflectorMaterial = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var _ref$mixBlur = _ref.mixBlur,\n      mixBlur = _ref$mixBlur === void 0 ? 0 : _ref$mixBlur,\n      _ref$mixStrength = _ref.mixStrength,\n      mixStrength = _ref$mixStrength === void 0 ? 1 : _ref$mixStrength,\n      _ref$resolution = _ref.resolution,\n      resolution = _ref$resolution === void 0 ? 256 : _ref$resolution,\n      _ref$blur = _ref.blur,\n      blur = _ref$blur === void 0 ? [0, 0] : _ref$blur,\n      _ref$minDepthThreshol = _ref.minDepthThreshold,\n      minDepthThreshold = _ref$minDepthThreshol === void 0 ? 0.9 : _ref$minDepthThreshol,\n      _ref$maxDepthThreshol = _ref.maxDepthThreshold,\n      maxDepthThreshold = _ref$maxDepthThreshol === void 0 ? 1 : _ref$maxDepthThreshol,\n      _ref$depthScale = _ref.depthScale,\n      depthScale = _ref$depthScale === void 0 ? 0 : _ref$depthScale,\n      _ref$depthToBlurRatio = _ref.depthToBlurRatioBias,\n      depthToBlurRatioBias = _ref$depthToBlurRatio === void 0 ? 0.25 : _ref$depthToBlurRatio,\n      _ref$mirror = _ref.mirror,\n      mirror = _ref$mirror === void 0 ? 0 : _ref$mirror,\n      _ref$distortion = _ref.distortion,\n      distortion = _ref$distortion === void 0 ? 1 : _ref$distortion,\n      _ref$mixContrast = _ref.mixContrast,\n      mixContrast = _ref$mixContrast === void 0 ? 1 : _ref$mixContrast,\n      distortionMap = _ref.distortionMap,\n      _ref$reflectorOffset = _ref.reflectorOffset,\n      reflectorOffset = _ref$reflectorOffset === void 0 ? 0 : _ref$reflectorOffset,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  var gl = useThree(function (_ref2) {\n    var gl = _ref2.gl;\n    return gl;\n  });\n  var camera = useThree(function (_ref3) {\n    var camera = _ref3.camera;\n    return camera;\n  });\n  var scene = useThree(function (_ref4) {\n    var scene = _ref4.scene;\n    return scene;\n  });\n  blur = Array.isArray(blur) ? blur : [blur, blur];\n  var hasBlur = blur[0] + blur[1] > 0;\n  var materialRef = React.useRef(null);\n\n  var _React$useState = React.useState(function () {\n    return new Plane();\n  }),\n      _React$useState2 = _slicedToArray(_React$useState, 1),\n      reflectorPlane = _React$useState2[0];\n\n  var _React$useState3 = React.useState(function () {\n    return new Vector3();\n  }),\n      _React$useState4 = _slicedToArray(_React$useState3, 1),\n      normal = _React$useState4[0];\n\n  var _React$useState5 = React.useState(function () {\n    return new Vector3();\n  }),\n      _React$useState6 = _slicedToArray(_React$useState5, 1),\n      reflectorWorldPosition = _React$useState6[0];\n\n  var _React$useState7 = React.useState(function () {\n    return new Vector3();\n  }),\n      _React$useState8 = _slicedToArray(_React$useState7, 1),\n      cameraWorldPosition = _React$useState8[0];\n\n  var _React$useState9 = React.useState(function () {\n    return new Matrix4();\n  }),\n      _React$useState10 = _slicedToArray(_React$useState9, 1),\n      rotationMatrix = _React$useState10[0];\n\n  var _React$useState11 = React.useState(function () {\n    return new Vector3(0, 0, -1);\n  }),\n      _React$useState12 = _slicedToArray(_React$useState11, 1),\n      lookAtPosition = _React$useState12[0];\n\n  var _React$useState13 = React.useState(function () {\n    return new Vector4();\n  }),\n      _React$useState14 = _slicedToArray(_React$useState13, 1),\n      clipPlane = _React$useState14[0];\n\n  var _React$useState15 = React.useState(function () {\n    return new Vector3();\n  }),\n      _React$useState16 = _slicedToArray(_React$useState15, 1),\n      view = _React$useState16[0];\n\n  var _React$useState17 = React.useState(function () {\n    return new Vector3();\n  }),\n      _React$useState18 = _slicedToArray(_React$useState17, 1),\n      target = _React$useState18[0];\n\n  var _React$useState19 = React.useState(function () {\n    return new Vector4();\n  }),\n      _React$useState20 = _slicedToArray(_React$useState19, 1),\n      q = _React$useState20[0];\n\n  var _React$useState21 = React.useState(function () {\n    return new Matrix4();\n  }),\n      _React$useState22 = _slicedToArray(_React$useState21, 1),\n      textureMatrix = _React$useState22[0];\n\n  var _React$useState23 = React.useState(function () {\n    return new PerspectiveCamera();\n  }),\n      _React$useState24 = _slicedToArray(_React$useState23, 1),\n      virtualCamera = _React$useState24[0];\n\n  var beforeRender = React.useCallback(function () {\n    var _materialRef$current; // TODO: As of R3f 7-8 this should be __r3f.parent\n\n\n    var parent = materialRef.current.parent || ((_materialRef$current = materialRef.current) == null ? void 0 : _materialRef$current.__r3f.parent);\n    if (!parent) return;\n    reflectorWorldPosition.setFromMatrixPosition(parent.matrixWorld);\n    cameraWorldPosition.setFromMatrixPosition(camera.matrixWorld);\n    rotationMatrix.extractRotation(parent.matrixWorld);\n    normal.set(0, 0, 1);\n    normal.applyMatrix4(rotationMatrix);\n    reflectorWorldPosition.addScaledVector(normal, reflectorOffset);\n    view.subVectors(reflectorWorldPosition, cameraWorldPosition); // Avoid rendering when reflector is facing away\n\n    if (view.dot(normal) > 0) return;\n    view.reflect(normal).negate();\n    view.add(reflectorWorldPosition);\n    rotationMatrix.extractRotation(camera.matrixWorld);\n    lookAtPosition.set(0, 0, -1);\n    lookAtPosition.applyMatrix4(rotationMatrix);\n    lookAtPosition.add(cameraWorldPosition);\n    target.subVectors(reflectorWorldPosition, lookAtPosition);\n    target.reflect(normal).negate();\n    target.add(reflectorWorldPosition);\n    virtualCamera.position.copy(view);\n    virtualCamera.up.set(0, 1, 0);\n    virtualCamera.up.applyMatrix4(rotationMatrix);\n    virtualCamera.up.reflect(normal);\n    virtualCamera.lookAt(target);\n    virtualCamera.far = camera.far; // Used in WebGLBackground\n\n    virtualCamera.updateMatrixWorld();\n    virtualCamera.projectionMatrix.copy(camera.projectionMatrix); // Update the texture matrix\n\n    textureMatrix.set(0.5, 0.0, 0.0, 0.5, 0.0, 0.5, 0.0, 0.5, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 1.0);\n    textureMatrix.multiply(virtualCamera.projectionMatrix);\n    textureMatrix.multiply(virtualCamera.matrixWorldInverse);\n    textureMatrix.multiply(parent.matrixWorld); // Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n    // Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n\n    reflectorPlane.setFromNormalAndCoplanarPoint(normal, reflectorWorldPosition);\n    reflectorPlane.applyMatrix4(virtualCamera.matrixWorldInverse);\n    clipPlane.set(reflectorPlane.normal.x, reflectorPlane.normal.y, reflectorPlane.normal.z, reflectorPlane.constant);\n    var projectionMatrix = virtualCamera.projectionMatrix;\n    q.x = (Math.sign(clipPlane.x) + projectionMatrix.elements[8]) / projectionMatrix.elements[0];\n    q.y = (Math.sign(clipPlane.y) + projectionMatrix.elements[9]) / projectionMatrix.elements[5];\n    q.z = -1.0;\n    q.w = (1.0 + projectionMatrix.elements[10]) / projectionMatrix.elements[14]; // Calculate the scaled plane vector\n\n    clipPlane.multiplyScalar(2.0 / clipPlane.dot(q)); // Replacing the third row of the projection matrix\n\n    projectionMatrix.elements[2] = clipPlane.x;\n    projectionMatrix.elements[6] = clipPlane.y;\n    projectionMatrix.elements[10] = clipPlane.z + 1.0;\n    projectionMatrix.elements[14] = clipPlane.w;\n  }, [camera, reflectorOffset]);\n\n  var _React$useMemo = React.useMemo(function () {\n    var parameters = {\n      minFilter: LinearFilter,\n      magFilter: LinearFilter,\n      encoding: gl.outputEncoding,\n      type: HalfFloatType\n    };\n    var fbo1 = new WebGLRenderTarget(resolution, resolution, parameters);\n    fbo1.depthBuffer = true;\n    fbo1.depthTexture = new DepthTexture(resolution, resolution);\n    fbo1.depthTexture.format = DepthFormat;\n    fbo1.depthTexture.type = UnsignedShortType;\n    var fbo2 = new WebGLRenderTarget(resolution, resolution, parameters);\n    var blurpass = new BlurPass({\n      gl: gl,\n      resolution: resolution,\n      width: blur[0],\n      height: blur[1],\n      minDepthThreshold: minDepthThreshold,\n      maxDepthThreshold: maxDepthThreshold,\n      depthScale: depthScale,\n      depthToBlurRatioBias: depthToBlurRatioBias\n    });\n    var reflectorProps = {\n      mirror: mirror,\n      textureMatrix: textureMatrix,\n      mixBlur: mixBlur,\n      tDiffuse: fbo1.texture,\n      tDepth: fbo1.depthTexture,\n      tDiffuseBlur: fbo2.texture,\n      hasBlur: hasBlur,\n      mixStrength: mixStrength,\n      minDepthThreshold: minDepthThreshold,\n      maxDepthThreshold: maxDepthThreshold,\n      depthScale: depthScale,\n      depthToBlurRatioBias: depthToBlurRatioBias,\n      distortion: distortion,\n      distortionMap: distortionMap,\n      mixContrast: mixContrast,\n      'defines-USE_BLUR': hasBlur ? '' : undefined,\n      'defines-USE_DEPTH': depthScale > 0 ? '' : undefined,\n      'defines-USE_DISTORTION': distortionMap ? '' : undefined\n    };\n    return [fbo1, fbo2, blurpass, reflectorProps];\n  }, [gl, blur, textureMatrix, resolution, mirror, hasBlur, mixBlur, mixStrength, minDepthThreshold, maxDepthThreshold, depthScale, depthToBlurRatioBias, distortion, distortionMap, mixContrast]),\n      _React$useMemo2 = _slicedToArray(_React$useMemo, 4),\n      fbo1 = _React$useMemo2[0],\n      fbo2 = _React$useMemo2[1],\n      blurpass = _React$useMemo2[2],\n      reflectorProps = _React$useMemo2[3];\n\n  useFrame(function () {\n    var _materialRef$current2; // TODO: As of R3f 7-8 this should be __r3f.parent\n\n\n    var parent = materialRef.current.parent || ((_materialRef$current2 = materialRef.current) == null ? void 0 : _materialRef$current2.__r3f.parent);\n    if (!parent) return;\n    parent.visible = false;\n    var currentXrEnabled = gl.xr.enabled;\n    var currentShadowAutoUpdate = gl.shadowMap.autoUpdate;\n    beforeRender();\n    gl.xr.enabled = false;\n    gl.shadowMap.autoUpdate = false;\n    gl.setRenderTarget(fbo1);\n    gl.state.buffers.depth.setMask(true);\n    if (!gl.autoClear) gl.clear();\n    gl.render(scene, virtualCamera);\n    if (hasBlur) blurpass.render(gl, fbo1, fbo2);\n    gl.xr.enabled = currentXrEnabled;\n    gl.shadowMap.autoUpdate = currentShadowAutoUpdate;\n    parent.visible = true;\n    gl.setRenderTarget(null);\n  });\n  return /*#__PURE__*/React.createElement(\"meshReflectorMaterialImpl\", _extends({\n    attach: \"material\" // Defines can't be updated dynamically, so we need to recreate the material\n    ,\n    key: 'key' + reflectorProps['defines-USE_BLUR'] + reflectorProps['defines-USE_DEPTH'] + reflectorProps['defines-USE_DISTORTION'],\n    ref: mergeRefs([materialRef, ref])\n  }, reflectorProps, props));\n});\nexport { MeshReflectorMaterial };","map":{"version":3,"names":["_extends","React","Plane","Vector3","Matrix4","Vector4","PerspectiveCamera","LinearFilter","HalfFloatType","WebGLRenderTarget","DepthTexture","DepthFormat","UnsignedShortType","extend","useThree","useFrame","mergeRefs","BlurPass","MeshReflectorMaterial","MeshReflectorMaterial$1","MeshReflectorMaterialImpl","forwardRef","ref","mixBlur","mixStrength","resolution","blur","minDepthThreshold","maxDepthThreshold","depthScale","depthToBlurRatioBias","mirror","distortion","mixContrast","distortionMap","reflectorOffset","props","gl","camera","scene","Array","isArray","hasBlur","materialRef","useRef","useState","reflectorPlane","normal","reflectorWorldPosition","cameraWorldPosition","rotationMatrix","lookAtPosition","clipPlane","view","target","q","textureMatrix","virtualCamera","beforeRender","useCallback","_materialRef$current","parent","current","__r3f","setFromMatrixPosition","matrixWorld","extractRotation","set","applyMatrix4","addScaledVector","subVectors","dot","reflect","negate","add","position","copy","up","lookAt","far","updateMatrixWorld","projectionMatrix","multiply","matrixWorldInverse","setFromNormalAndCoplanarPoint","x","y","z","constant","Math","sign","elements","w","multiplyScalar","useMemo","parameters","minFilter","magFilter","encoding","outputEncoding","type","fbo1","depthBuffer","depthTexture","format","fbo2","blurpass","width","height","reflectorProps","tDiffuse","texture","tDepth","tDiffuseBlur","undefined","_materialRef$current2","visible","currentXrEnabled","xr","enabled","currentShadowAutoUpdate","shadowMap","autoUpdate","setRenderTarget","state","buffers","depth","setMask","autoClear","clear","render","createElement","attach","key"],"sources":["D:/Jord/l4fycy/node_modules/@react-three/drei/core/MeshReflectorMaterial.js"],"sourcesContent":["import _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport { Plane, Vector3, Matrix4, Vector4, PerspectiveCamera, LinearFilter, HalfFloatType, WebGLRenderTarget, DepthTexture, DepthFormat, UnsignedShortType } from 'three';\nimport { extend, useThree, useFrame } from '@react-three/fiber';\nimport mergeRefs from 'react-merge-refs';\nimport { BlurPass } from '../materials/BlurPass.js';\nimport { MeshReflectorMaterial as MeshReflectorMaterial$1 } from '../materials/MeshReflectorMaterial.js';\n\nextend({\n  MeshReflectorMaterialImpl: MeshReflectorMaterial$1\n});\nconst MeshReflectorMaterial = /*#__PURE__*/React.forwardRef(({\n  mixBlur = 0,\n  mixStrength = 1,\n  resolution = 256,\n  blur = [0, 0],\n  minDepthThreshold = 0.9,\n  maxDepthThreshold = 1,\n  depthScale = 0,\n  depthToBlurRatioBias = 0.25,\n  mirror = 0,\n  distortion = 1,\n  mixContrast = 1,\n  distortionMap,\n  reflectorOffset = 0,\n  ...props\n}, ref) => {\n  const gl = useThree(({\n    gl\n  }) => gl);\n  const camera = useThree(({\n    camera\n  }) => camera);\n  const scene = useThree(({\n    scene\n  }) => scene);\n  blur = Array.isArray(blur) ? blur : [blur, blur];\n  const hasBlur = blur[0] + blur[1] > 0;\n  const materialRef = React.useRef(null);\n  const [reflectorPlane] = React.useState(() => new Plane());\n  const [normal] = React.useState(() => new Vector3());\n  const [reflectorWorldPosition] = React.useState(() => new Vector3());\n  const [cameraWorldPosition] = React.useState(() => new Vector3());\n  const [rotationMatrix] = React.useState(() => new Matrix4());\n  const [lookAtPosition] = React.useState(() => new Vector3(0, 0, -1));\n  const [clipPlane] = React.useState(() => new Vector4());\n  const [view] = React.useState(() => new Vector3());\n  const [target] = React.useState(() => new Vector3());\n  const [q] = React.useState(() => new Vector4());\n  const [textureMatrix] = React.useState(() => new Matrix4());\n  const [virtualCamera] = React.useState(() => new PerspectiveCamera());\n  const beforeRender = React.useCallback(() => {\n    var _materialRef$current;\n\n    // TODO: As of R3f 7-8 this should be __r3f.parent\n    const parent = materialRef.current.parent || ((_materialRef$current = materialRef.current) == null ? void 0 : _materialRef$current.__r3f.parent);\n    if (!parent) return;\n    reflectorWorldPosition.setFromMatrixPosition(parent.matrixWorld);\n    cameraWorldPosition.setFromMatrixPosition(camera.matrixWorld);\n    rotationMatrix.extractRotation(parent.matrixWorld);\n    normal.set(0, 0, 1);\n    normal.applyMatrix4(rotationMatrix);\n    reflectorWorldPosition.addScaledVector(normal, reflectorOffset);\n    view.subVectors(reflectorWorldPosition, cameraWorldPosition); // Avoid rendering when reflector is facing away\n\n    if (view.dot(normal) > 0) return;\n    view.reflect(normal).negate();\n    view.add(reflectorWorldPosition);\n    rotationMatrix.extractRotation(camera.matrixWorld);\n    lookAtPosition.set(0, 0, -1);\n    lookAtPosition.applyMatrix4(rotationMatrix);\n    lookAtPosition.add(cameraWorldPosition);\n    target.subVectors(reflectorWorldPosition, lookAtPosition);\n    target.reflect(normal).negate();\n    target.add(reflectorWorldPosition);\n    virtualCamera.position.copy(view);\n    virtualCamera.up.set(0, 1, 0);\n    virtualCamera.up.applyMatrix4(rotationMatrix);\n    virtualCamera.up.reflect(normal);\n    virtualCamera.lookAt(target);\n    virtualCamera.far = camera.far; // Used in WebGLBackground\n\n    virtualCamera.updateMatrixWorld();\n    virtualCamera.projectionMatrix.copy(camera.projectionMatrix); // Update the texture matrix\n\n    textureMatrix.set(0.5, 0.0, 0.0, 0.5, 0.0, 0.5, 0.0, 0.5, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 1.0);\n    textureMatrix.multiply(virtualCamera.projectionMatrix);\n    textureMatrix.multiply(virtualCamera.matrixWorldInverse);\n    textureMatrix.multiply(parent.matrixWorld); // Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n    // Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n\n    reflectorPlane.setFromNormalAndCoplanarPoint(normal, reflectorWorldPosition);\n    reflectorPlane.applyMatrix4(virtualCamera.matrixWorldInverse);\n    clipPlane.set(reflectorPlane.normal.x, reflectorPlane.normal.y, reflectorPlane.normal.z, reflectorPlane.constant);\n    const projectionMatrix = virtualCamera.projectionMatrix;\n    q.x = (Math.sign(clipPlane.x) + projectionMatrix.elements[8]) / projectionMatrix.elements[0];\n    q.y = (Math.sign(clipPlane.y) + projectionMatrix.elements[9]) / projectionMatrix.elements[5];\n    q.z = -1.0;\n    q.w = (1.0 + projectionMatrix.elements[10]) / projectionMatrix.elements[14]; // Calculate the scaled plane vector\n\n    clipPlane.multiplyScalar(2.0 / clipPlane.dot(q)); // Replacing the third row of the projection matrix\n\n    projectionMatrix.elements[2] = clipPlane.x;\n    projectionMatrix.elements[6] = clipPlane.y;\n    projectionMatrix.elements[10] = clipPlane.z + 1.0;\n    projectionMatrix.elements[14] = clipPlane.w;\n  }, [camera, reflectorOffset]);\n  const [fbo1, fbo2, blurpass, reflectorProps] = React.useMemo(() => {\n    const parameters = {\n      minFilter: LinearFilter,\n      magFilter: LinearFilter,\n      encoding: gl.outputEncoding,\n      type: HalfFloatType\n    };\n    const fbo1 = new WebGLRenderTarget(resolution, resolution, parameters);\n    fbo1.depthBuffer = true;\n    fbo1.depthTexture = new DepthTexture(resolution, resolution);\n    fbo1.depthTexture.format = DepthFormat;\n    fbo1.depthTexture.type = UnsignedShortType;\n    const fbo2 = new WebGLRenderTarget(resolution, resolution, parameters);\n    const blurpass = new BlurPass({\n      gl,\n      resolution,\n      width: blur[0],\n      height: blur[1],\n      minDepthThreshold,\n      maxDepthThreshold,\n      depthScale,\n      depthToBlurRatioBias\n    });\n    const reflectorProps = {\n      mirror,\n      textureMatrix,\n      mixBlur,\n      tDiffuse: fbo1.texture,\n      tDepth: fbo1.depthTexture,\n      tDiffuseBlur: fbo2.texture,\n      hasBlur,\n      mixStrength,\n      minDepthThreshold,\n      maxDepthThreshold,\n      depthScale,\n      depthToBlurRatioBias,\n      distortion,\n      distortionMap,\n      mixContrast,\n      'defines-USE_BLUR': hasBlur ? '' : undefined,\n      'defines-USE_DEPTH': depthScale > 0 ? '' : undefined,\n      'defines-USE_DISTORTION': distortionMap ? '' : undefined\n    };\n    return [fbo1, fbo2, blurpass, reflectorProps];\n  }, [gl, blur, textureMatrix, resolution, mirror, hasBlur, mixBlur, mixStrength, minDepthThreshold, maxDepthThreshold, depthScale, depthToBlurRatioBias, distortion, distortionMap, mixContrast]);\n  useFrame(() => {\n    var _materialRef$current2;\n\n    // TODO: As of R3f 7-8 this should be __r3f.parent\n    const parent = materialRef.current.parent || ((_materialRef$current2 = materialRef.current) == null ? void 0 : _materialRef$current2.__r3f.parent);\n    if (!parent) return;\n    parent.visible = false;\n    const currentXrEnabled = gl.xr.enabled;\n    const currentShadowAutoUpdate = gl.shadowMap.autoUpdate;\n    beforeRender();\n    gl.xr.enabled = false;\n    gl.shadowMap.autoUpdate = false;\n    gl.setRenderTarget(fbo1);\n    gl.state.buffers.depth.setMask(true);\n    if (!gl.autoClear) gl.clear();\n    gl.render(scene, virtualCamera);\n    if (hasBlur) blurpass.render(gl, fbo1, fbo2);\n    gl.xr.enabled = currentXrEnabled;\n    gl.shadowMap.autoUpdate = currentShadowAutoUpdate;\n    parent.visible = true;\n    gl.setRenderTarget(null);\n  });\n  return /*#__PURE__*/React.createElement(\"meshReflectorMaterialImpl\", _extends({\n    attach: \"material\" // Defines can't be updated dynamically, so we need to recreate the material\n    ,\n    key: 'key' + reflectorProps['defines-USE_BLUR'] + reflectorProps['defines-USE_DEPTH'] + reflectorProps['defines-USE_DISTORTION'],\n    ref: mergeRefs([materialRef, ref])\n  }, reflectorProps, props));\n});\n\nexport { MeshReflectorMaterial };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}