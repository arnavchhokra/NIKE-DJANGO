{"ast":null,"code":"import _createClass from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _assertThisInitialized from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _get from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\nimport { Object3D, Raycaster, Vector3, Quaternion, Euler, Matrix4, Color, MeshBasicMaterial, DoubleSide, LineBasicMaterial, CylinderGeometry, BoxGeometry, BufferGeometry, Float32BufferAttribute, Mesh, Line, OctahedronGeometry, PlaneGeometry, TorusGeometry, SphereGeometry } from 'three';\n\nvar TransformControls = /*#__PURE__*/function (_Object3D) {\n  _inherits(TransformControls, _Object3D);\n\n  var _super = _createSuper(TransformControls);\n\n  // events\n  function TransformControls(camera, _domElement) {\n    var _thisSuper, _this;\n\n    _classCallCheck(this, TransformControls);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"isTransformControls\", true);\n\n    _defineProperty(_assertThisInitialized(_this), \"visible\", false);\n\n    _defineProperty(_assertThisInitialized(_this), \"domElement\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"raycaster\", new Raycaster());\n\n    _defineProperty(_assertThisInitialized(_this), \"gizmo\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"plane\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"tempVector\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"tempVector2\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"tempQuaternion\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this), \"unit\", {\n      X: new Vector3(1, 0, 0),\n      Y: new Vector3(0, 1, 0),\n      Z: new Vector3(0, 0, 1)\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"pointStart\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"pointEnd\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"offset\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"rotationAxis\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"startNorm\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"endNorm\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"rotationAngle\", 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"cameraPosition\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"cameraQuaternion\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this), \"cameraScale\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"parentPosition\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"parentQuaternion\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this), \"parentQuaternionInv\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this), \"parentScale\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"worldPositionStart\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"worldQuaternionStart\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this), \"worldScaleStart\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"worldPosition\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"worldQuaternion\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this), \"worldQuaternionInv\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this), \"worldScale\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"eye\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"positionStart\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"quaternionStart\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this), \"scaleStart\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this), \"camera\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"object\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"enabled\", true);\n\n    _defineProperty(_assertThisInitialized(_this), \"axis\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"mode\", 'translate');\n\n    _defineProperty(_assertThisInitialized(_this), \"translationSnap\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"rotationSnap\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"scaleSnap\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"space\", 'world');\n\n    _defineProperty(_assertThisInitialized(_this), \"size\", 1);\n\n    _defineProperty(_assertThisInitialized(_this), \"dragging\", false);\n\n    _defineProperty(_assertThisInitialized(_this), \"showX\", true);\n\n    _defineProperty(_assertThisInitialized(_this), \"showY\", true);\n\n    _defineProperty(_assertThisInitialized(_this), \"showZ\", true);\n\n    _defineProperty(_assertThisInitialized(_this), \"changeEvent\", {\n      type: 'change'\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"mouseDownEvent\", {\n      type: 'mouseDown',\n      mode: _this.mode\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"mouseUpEvent\", {\n      type: 'mouseUp',\n      mode: _this.mode\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"objectChangeEvent\", {\n      type: 'objectChange'\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"intersectObjectWithRay\", function (object, raycaster, includeInvisible) {\n      var allIntersections = raycaster.intersectObject(object, true);\n\n      for (var i = 0; i < allIntersections.length; i++) {\n        if (allIntersections[i].object.visible || includeInvisible) {\n          return allIntersections[i];\n        }\n      }\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"attach\", function (object) {\n      _this.object = object;\n      _this.visible = true;\n      return _assertThisInitialized(_this);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"detach\", function () {\n      _this.object = undefined;\n      _this.visible = false;\n      _this.axis = null;\n      return _assertThisInitialized(_this);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"reset\", function () {\n      if (!_this.enabled) return _assertThisInitialized(_this);\n\n      if (_this.dragging) {\n        if (_this.object !== undefined) {\n          _this.object.position.copy(_this.positionStart);\n\n          _this.object.quaternion.copy(_this.quaternionStart);\n\n          _this.object.scale.copy(_this.scaleStart);\n\n          _this.dispatchEvent(_this.changeEvent);\n\n          _this.dispatchEvent(_this.objectChangeEvent);\n\n          _this.pointStart.copy(_this.pointEnd);\n        }\n      }\n\n      return _assertThisInitialized(_this);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateMatrixWorld\", function () {\n      if (_this.object !== undefined) {\n        _this.object.updateMatrixWorld();\n\n        if (_this.object.parent === null) {\n          console.error('TransformControls: The attached 3D object must be a part of the scene graph.');\n        } else {\n          _this.object.parent.matrixWorld.decompose(_this.parentPosition, _this.parentQuaternion, _this.parentScale);\n        }\n\n        _this.object.matrixWorld.decompose(_this.worldPosition, _this.worldQuaternion, _this.worldScale);\n\n        _this.parentQuaternionInv.copy(_this.parentQuaternion).invert();\n\n        _this.worldQuaternionInv.copy(_this.worldQuaternion).invert();\n      }\n\n      _this.camera.updateMatrixWorld();\n\n      _this.camera.matrixWorld.decompose(_this.cameraPosition, _this.cameraQuaternion, _this.cameraScale);\n\n      _this.eye.copy(_this.cameraPosition).sub(_this.worldPosition).normalize();\n\n      _get((_thisSuper = _assertThisInitialized(_this), _getPrototypeOf(TransformControls.prototype)), \"updateMatrixWorld\", _thisSuper).call(_thisSuper);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"pointerHover\", function (pointer) {\n      if (_this.object === undefined || _this.dragging === true) return;\n\n      _this.raycaster.setFromCamera(pointer, _this.camera);\n\n      var intersect = _this.intersectObjectWithRay(_this.gizmo.picker[_this.mode], _this.raycaster);\n\n      if (intersect) {\n        _this.axis = intersect.object.name;\n      } else {\n        _this.axis = null;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"pointerDown\", function (pointer) {\n      if (_this.object === undefined || _this.dragging === true || pointer.button !== 0) return;\n\n      if (_this.axis !== null) {\n        _this.raycaster.setFromCamera(pointer, _this.camera);\n\n        var planeIntersect = _this.intersectObjectWithRay(_this.plane, _this.raycaster, true);\n\n        if (planeIntersect) {\n          var space = _this.space;\n\n          if (_this.mode === 'scale') {\n            space = 'local';\n          } else if (_this.axis === 'E' || _this.axis === 'XYZE' || _this.axis === 'XYZ') {\n            space = 'world';\n          }\n\n          if (space === 'local' && _this.mode === 'rotate') {\n            var snap = _this.rotationSnap;\n            if (_this.axis === 'X' && snap) _this.object.rotation.x = Math.round(_this.object.rotation.x / snap) * snap;\n            if (_this.axis === 'Y' && snap) _this.object.rotation.y = Math.round(_this.object.rotation.y / snap) * snap;\n            if (_this.axis === 'Z' && snap) _this.object.rotation.z = Math.round(_this.object.rotation.z / snap) * snap;\n          }\n\n          _this.object.updateMatrixWorld();\n\n          if (_this.object.parent) {\n            _this.object.parent.updateMatrixWorld();\n          }\n\n          _this.positionStart.copy(_this.object.position);\n\n          _this.quaternionStart.copy(_this.object.quaternion);\n\n          _this.scaleStart.copy(_this.object.scale);\n\n          _this.object.matrixWorld.decompose(_this.worldPositionStart, _this.worldQuaternionStart, _this.worldScaleStart);\n\n          _this.pointStart.copy(planeIntersect.point).sub(_this.worldPositionStart);\n        }\n\n        _this.dragging = true;\n        _this.mouseDownEvent.mode = _this.mode;\n\n        _this.dispatchEvent(_this.mouseDownEvent);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"pointerMove\", function (pointer) {\n      var axis = _this.axis;\n      var mode = _this.mode;\n      var object = _this.object;\n      var space = _this.space;\n\n      if (mode === 'scale') {\n        space = 'local';\n      } else if (axis === 'E' || axis === 'XYZE' || axis === 'XYZ') {\n        space = 'world';\n      }\n\n      if (object === undefined || axis === null || _this.dragging === false || pointer.button !== -1) return;\n\n      _this.raycaster.setFromCamera(pointer, _this.camera);\n\n      var planeIntersect = _this.intersectObjectWithRay(_this.plane, _this.raycaster, true);\n\n      if (!planeIntersect) return;\n\n      _this.pointEnd.copy(planeIntersect.point).sub(_this.worldPositionStart);\n\n      if (mode === 'translate') {\n        // Apply translate\n        _this.offset.copy(_this.pointEnd).sub(_this.pointStart);\n\n        if (space === 'local' && axis !== 'XYZ') {\n          _this.offset.applyQuaternion(_this.worldQuaternionInv);\n        }\n\n        if (axis.indexOf('X') === -1) _this.offset.x = 0;\n        if (axis.indexOf('Y') === -1) _this.offset.y = 0;\n        if (axis.indexOf('Z') === -1) _this.offset.z = 0;\n\n        if (space === 'local' && axis !== 'XYZ') {\n          _this.offset.applyQuaternion(_this.quaternionStart).divide(_this.parentScale);\n        } else {\n          _this.offset.applyQuaternion(_this.parentQuaternionInv).divide(_this.parentScale);\n        }\n\n        object.position.copy(_this.offset).add(_this.positionStart); // Apply translation snap\n\n        if (_this.translationSnap) {\n          if (space === 'local') {\n            object.position.applyQuaternion(_this.tempQuaternion.copy(_this.quaternionStart).invert());\n\n            if (axis.search('X') !== -1) {\n              object.position.x = Math.round(object.position.x / _this.translationSnap) * _this.translationSnap;\n            }\n\n            if (axis.search('Y') !== -1) {\n              object.position.y = Math.round(object.position.y / _this.translationSnap) * _this.translationSnap;\n            }\n\n            if (axis.search('Z') !== -1) {\n              object.position.z = Math.round(object.position.z / _this.translationSnap) * _this.translationSnap;\n            }\n\n            object.position.applyQuaternion(_this.quaternionStart);\n          }\n\n          if (space === 'world') {\n            if (object.parent) {\n              object.position.add(_this.tempVector.setFromMatrixPosition(object.parent.matrixWorld));\n            }\n\n            if (axis.search('X') !== -1) {\n              object.position.x = Math.round(object.position.x / _this.translationSnap) * _this.translationSnap;\n            }\n\n            if (axis.search('Y') !== -1) {\n              object.position.y = Math.round(object.position.y / _this.translationSnap) * _this.translationSnap;\n            }\n\n            if (axis.search('Z') !== -1) {\n              object.position.z = Math.round(object.position.z / _this.translationSnap) * _this.translationSnap;\n            }\n\n            if (object.parent) {\n              object.position.sub(_this.tempVector.setFromMatrixPosition(object.parent.matrixWorld));\n            }\n          }\n        }\n      } else if (mode === 'scale') {\n        if (axis.search('XYZ') !== -1) {\n          var d = _this.pointEnd.length() / _this.pointStart.length();\n\n          if (_this.pointEnd.dot(_this.pointStart) < 0) d *= -1;\n\n          _this.tempVector2.set(d, d, d);\n        } else {\n          _this.tempVector.copy(_this.pointStart);\n\n          _this.tempVector2.copy(_this.pointEnd);\n\n          _this.tempVector.applyQuaternion(_this.worldQuaternionInv);\n\n          _this.tempVector2.applyQuaternion(_this.worldQuaternionInv);\n\n          _this.tempVector2.divide(_this.tempVector);\n\n          if (axis.search('X') === -1) {\n            _this.tempVector2.x = 1;\n          }\n\n          if (axis.search('Y') === -1) {\n            _this.tempVector2.y = 1;\n          }\n\n          if (axis.search('Z') === -1) {\n            _this.tempVector2.z = 1;\n          }\n        } // Apply scale\n\n\n        object.scale.copy(_this.scaleStart).multiply(_this.tempVector2);\n\n        if (_this.scaleSnap && _this.object) {\n          if (axis.search('X') !== -1) {\n            _this.object.scale.x = Math.round(object.scale.x / _this.scaleSnap) * _this.scaleSnap || _this.scaleSnap;\n          }\n\n          if (axis.search('Y') !== -1) {\n            object.scale.y = Math.round(object.scale.y / _this.scaleSnap) * _this.scaleSnap || _this.scaleSnap;\n          }\n\n          if (axis.search('Z') !== -1) {\n            object.scale.z = Math.round(object.scale.z / _this.scaleSnap) * _this.scaleSnap || _this.scaleSnap;\n          }\n        }\n      } else if (mode === 'rotate') {\n        _this.offset.copy(_this.pointEnd).sub(_this.pointStart);\n\n        var ROTATION_SPEED = 20 / _this.worldPosition.distanceTo(_this.tempVector.setFromMatrixPosition(_this.camera.matrixWorld));\n\n        if (axis === 'E') {\n          _this.rotationAxis.copy(_this.eye);\n\n          _this.rotationAngle = _this.pointEnd.angleTo(_this.pointStart);\n\n          _this.startNorm.copy(_this.pointStart).normalize();\n\n          _this.endNorm.copy(_this.pointEnd).normalize();\n\n          _this.rotationAngle *= _this.endNorm.cross(_this.startNorm).dot(_this.eye) < 0 ? 1 : -1;\n        } else if (axis === 'XYZE') {\n          _this.rotationAxis.copy(_this.offset).cross(_this.eye).normalize();\n\n          _this.rotationAngle = _this.offset.dot(_this.tempVector.copy(_this.rotationAxis).cross(_this.eye)) * ROTATION_SPEED;\n        } else if (axis === 'X' || axis === 'Y' || axis === 'Z') {\n          _this.rotationAxis.copy(_this.unit[axis]);\n\n          _this.tempVector.copy(_this.unit[axis]);\n\n          if (space === 'local') {\n            _this.tempVector.applyQuaternion(_this.worldQuaternion);\n          }\n\n          _this.rotationAngle = _this.offset.dot(_this.tempVector.cross(_this.eye).normalize()) * ROTATION_SPEED;\n        } // Apply rotation snap\n\n\n        if (_this.rotationSnap) {\n          _this.rotationAngle = Math.round(_this.rotationAngle / _this.rotationSnap) * _this.rotationSnap;\n        } // Apply rotate\n\n\n        if (space === 'local' && axis !== 'E' && axis !== 'XYZE') {\n          object.quaternion.copy(_this.quaternionStart);\n          object.quaternion.multiply(_this.tempQuaternion.setFromAxisAngle(_this.rotationAxis, _this.rotationAngle)).normalize();\n        } else {\n          _this.rotationAxis.applyQuaternion(_this.parentQuaternionInv);\n\n          object.quaternion.copy(_this.tempQuaternion.setFromAxisAngle(_this.rotationAxis, _this.rotationAngle));\n          object.quaternion.multiply(_this.quaternionStart).normalize();\n        }\n      }\n\n      _this.dispatchEvent(_this.changeEvent);\n\n      _this.dispatchEvent(_this.objectChangeEvent);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"pointerUp\", function (pointer) {\n      if (pointer.button !== 0) return;\n\n      if (_this.dragging && _this.axis !== null) {\n        _this.mouseUpEvent.mode = _this.mode;\n\n        _this.dispatchEvent(_this.mouseUpEvent);\n      }\n\n      _this.dragging = false;\n      _this.axis = null;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getPointer\", function (event) {\n      var _this$domElement$owne;\n\n      if (_this.domElement && (_this$domElement$owne = _this.domElement.ownerDocument) !== null && _this$domElement$owne !== void 0 && _this$domElement$owne.pointerLockElement) {\n        return {\n          x: 0,\n          y: 0,\n          button: event.button\n        };\n      } else {\n        var _this$domElement;\n\n        var pointer = event.changedTouches ? event.changedTouches[0] : event;\n        var rect = (_this$domElement = _this.domElement) === null || _this$domElement === void 0 ? void 0 : _this$domElement.getBoundingClientRect();\n        return {\n          x: (pointer.clientX - rect.left) / rect.width * 2 - 1,\n          y: -(pointer.clientY - rect.top) / rect.height * 2 + 1,\n          button: event.button\n        };\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onPointerHover\", function (event) {\n      if (!_this.enabled) return;\n\n      switch (event.pointerType) {\n        case 'mouse':\n        case 'pen':\n          _this.pointerHover(_this.getPointer(event));\n\n          break;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onPointerDown\", function (event) {\n      if (!_this.enabled || !_this.domElement) return;\n      _this.domElement.style.touchAction = 'none'; // disable touch scroll\n\n      _this.domElement.ownerDocument.addEventListener('pointermove', _this.onPointerMove);\n\n      _this.pointerHover(_this.getPointer(event));\n\n      _this.pointerDown(_this.getPointer(event));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onPointerMove\", function (event) {\n      if (!_this.enabled) return;\n\n      _this.pointerMove(_this.getPointer(event));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onPointerUp\", function (event) {\n      if (!_this.enabled || !_this.domElement) return;\n      _this.domElement.style.touchAction = '';\n\n      _this.domElement.ownerDocument.removeEventListener('pointermove', _this.onPointerMove);\n\n      _this.pointerUp(_this.getPointer(event));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getMode\", function () {\n      return _this.mode;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setMode\", function (mode) {\n      _this.mode = mode;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setTranslationSnap\", function (translationSnap) {\n      _this.translationSnap = translationSnap;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setRotationSnap\", function (rotationSnap) {\n      _this.rotationSnap = rotationSnap;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setScaleSnap\", function (scaleSnap) {\n      _this.scaleSnap = scaleSnap;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setSize\", function (size) {\n      _this.size = size;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setSpace\", function (space) {\n      _this.space = space;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"update\", function () {\n      console.warn('THREE.TransformControls: update function has no more functionality and therefore has been deprecated.');\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"connect\", function (domElement) {\n      if (domElement === document) {\n        console.error('THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.');\n      }\n\n      _this.domElement = domElement;\n\n      _this.domElement.addEventListener('pointerdown', _this.onPointerDown);\n\n      _this.domElement.addEventListener('pointermove', _this.onPointerHover);\n\n      _this.domElement.ownerDocument.addEventListener('pointerup', _this.onPointerUp);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"dispose\", function () {\n      var _this$domElement2, _this$domElement3, _this$domElement4, _this$domElement4$own, _this$domElement5, _this$domElement5$own;\n\n      (_this$domElement2 = _this.domElement) === null || _this$domElement2 === void 0 ? void 0 : _this$domElement2.removeEventListener('pointerdown', _this.onPointerDown);\n      (_this$domElement3 = _this.domElement) === null || _this$domElement3 === void 0 ? void 0 : _this$domElement3.removeEventListener('pointermove', _this.onPointerHover);\n      (_this$domElement4 = _this.domElement) === null || _this$domElement4 === void 0 ? void 0 : (_this$domElement4$own = _this$domElement4.ownerDocument) === null || _this$domElement4$own === void 0 ? void 0 : _this$domElement4$own.removeEventListener('pointermove', _this.onPointerMove);\n      (_this$domElement5 = _this.domElement) === null || _this$domElement5 === void 0 ? void 0 : (_this$domElement5$own = _this$domElement5.ownerDocument) === null || _this$domElement5$own === void 0 ? void 0 : _this$domElement5$own.removeEventListener('pointerup', _this.onPointerUp);\n\n      _this.traverse(function (child) {\n        var mesh = child;\n\n        if (mesh.geometry) {\n          mesh.geometry.dispose();\n        }\n\n        if (mesh.material) {\n          mesh.material.dispose();\n        }\n      });\n    });\n\n    _this.domElement = _domElement;\n    _this.camera = camera;\n    _this.gizmo = new TransformControlsGizmo();\n\n    _this.add(_this.gizmo);\n\n    _this.plane = new TransformControlsPlane();\n\n    _this.add(_this.plane); // Defined getter, setter and store for a property\n\n\n    var defineProperty = function defineProperty(propName, defaultValue) {\n      var propValue = defaultValue;\n      Object.defineProperty(_assertThisInitialized(_this), propName, {\n        get: function get() {\n          return propValue !== undefined ? propValue : defaultValue;\n        },\n        set: function set(value) {\n          if (propValue !== value) {\n            propValue = value;\n            this.plane[propName] = value;\n            this.gizmo[propName] = value;\n            this.dispatchEvent({\n              type: propName + '-changed',\n              value: value\n            });\n            this.dispatchEvent(this.changeEvent);\n          }\n        }\n      }); //@ts-ignore\n\n      _this[propName] = defaultValue; // @ts-ignore\n\n      _this.plane[propName] = defaultValue; // @ts-ignore\n\n      _this.gizmo[propName] = defaultValue;\n    };\n\n    defineProperty('camera', _this.camera);\n    defineProperty('object', _this.object);\n    defineProperty('enabled', _this.enabled);\n    defineProperty('axis', _this.axis);\n    defineProperty('mode', _this.mode);\n    defineProperty('translationSnap', _this.translationSnap);\n    defineProperty('rotationSnap', _this.rotationSnap);\n    defineProperty('scaleSnap', _this.scaleSnap);\n    defineProperty('space', _this.space);\n    defineProperty('size', _this.size);\n    defineProperty('dragging', _this.dragging);\n    defineProperty('showX', _this.showX);\n    defineProperty('showY', _this.showY);\n    defineProperty('showZ', _this.showZ);\n    defineProperty('worldPosition', _this.worldPosition);\n    defineProperty('worldPositionStart', _this.worldPositionStart);\n    defineProperty('worldQuaternion', _this.worldQuaternion);\n    defineProperty('worldQuaternionStart', _this.worldQuaternionStart);\n    defineProperty('cameraPosition', _this.cameraPosition);\n    defineProperty('cameraQuaternion', _this.cameraQuaternion);\n    defineProperty('pointStart', _this.pointStart);\n    defineProperty('pointEnd', _this.pointEnd);\n    defineProperty('rotationAxis', _this.rotationAxis);\n    defineProperty('rotationAngle', _this.rotationAngle);\n    defineProperty('eye', _this.eye); // connect events\n\n    if (_domElement !== undefined) _this.connect(_domElement);\n    return _this;\n  }\n\n  return _createClass(TransformControls);\n}(Object3D);\n\nvar TransformControlsGizmo = /*#__PURE__*/function (_Object3D2) {\n  _inherits(TransformControlsGizmo, _Object3D2);\n\n  var _super2 = _createSuper(TransformControlsGizmo);\n\n  // these are set from parent class TransformControls\n  function TransformControlsGizmo() {\n    var _thisSuper2, _this2;\n\n    _classCallCheck(this, TransformControlsGizmo);\n\n    _this2 = _super2.call(this);\n\n    _defineProperty(_assertThisInitialized(_this2), \"isTransformControlsGizmo\", true);\n\n    _defineProperty(_assertThisInitialized(_this2), \"type\", 'TransformControlsGizmo');\n\n    _defineProperty(_assertThisInitialized(_this2), \"tempVector\", new Vector3(0, 0, 0));\n\n    _defineProperty(_assertThisInitialized(_this2), \"tempEuler\", new Euler());\n\n    _defineProperty(_assertThisInitialized(_this2), \"alignVector\", new Vector3(0, 1, 0));\n\n    _defineProperty(_assertThisInitialized(_this2), \"zeroVector\", new Vector3(0, 0, 0));\n\n    _defineProperty(_assertThisInitialized(_this2), \"lookAtMatrix\", new Matrix4());\n\n    _defineProperty(_assertThisInitialized(_this2), \"tempQuaternion\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this2), \"tempQuaternion2\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this2), \"identityQuaternion\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this2), \"unitX\", new Vector3(1, 0, 0));\n\n    _defineProperty(_assertThisInitialized(_this2), \"unitY\", new Vector3(0, 1, 0));\n\n    _defineProperty(_assertThisInitialized(_this2), \"unitZ\", new Vector3(0, 0, 1));\n\n    _defineProperty(_assertThisInitialized(_this2), \"gizmo\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this2), \"picker\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this2), \"helper\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this2), \"rotationAxis\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this2), \"cameraPosition\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this2), \"worldPositionStart\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this2), \"worldQuaternionStart\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this2), \"worldPosition\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this2), \"worldQuaternion\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this2), \"eye\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this2), \"camera\", null);\n\n    _defineProperty(_assertThisInitialized(_this2), \"enabled\", true);\n\n    _defineProperty(_assertThisInitialized(_this2), \"axis\", null);\n\n    _defineProperty(_assertThisInitialized(_this2), \"mode\", 'translate');\n\n    _defineProperty(_assertThisInitialized(_this2), \"space\", 'world');\n\n    _defineProperty(_assertThisInitialized(_this2), \"size\", 1);\n\n    _defineProperty(_assertThisInitialized(_this2), \"dragging\", false);\n\n    _defineProperty(_assertThisInitialized(_this2), \"showX\", true);\n\n    _defineProperty(_assertThisInitialized(_this2), \"showY\", true);\n\n    _defineProperty(_assertThisInitialized(_this2), \"showZ\", true);\n\n    _defineProperty(_assertThisInitialized(_this2), \"updateMatrixWorld\", function () {\n      var space = _this2.space;\n\n      if (_this2.mode === 'scale') {\n        space = 'local'; // scale always oriented to local rotation\n      }\n\n      var quaternion = space === 'local' ? _this2.worldQuaternion : _this2.identityQuaternion; // Show only gizmos for current transform mode\n\n      _this2.gizmo['translate'].visible = _this2.mode === 'translate';\n      _this2.gizmo['rotate'].visible = _this2.mode === 'rotate';\n      _this2.gizmo['scale'].visible = _this2.mode === 'scale';\n      _this2.helper['translate'].visible = _this2.mode === 'translate';\n      _this2.helper['rotate'].visible = _this2.mode === 'rotate';\n      _this2.helper['scale'].visible = _this2.mode === 'scale';\n      var handles = [];\n      handles = handles.concat(_this2.picker[_this2.mode].children);\n      handles = handles.concat(_this2.gizmo[_this2.mode].children);\n      handles = handles.concat(_this2.helper[_this2.mode].children);\n\n      var _loop = function _loop(i) {\n        var handle = handles[i]; // hide aligned to camera\n\n        handle.visible = true;\n        handle.rotation.set(0, 0, 0);\n        handle.position.copy(_this2.worldPosition);\n        var factor = void 0;\n\n        if (_this2.camera.isOrthographicCamera) {\n          factor = (_this2.camera.top - _this2.camera.bottom) / _this2.camera.zoom;\n        } else {\n          factor = _this2.worldPosition.distanceTo(_this2.cameraPosition) * Math.min(1.9 * Math.tan(Math.PI * _this2.camera.fov / 360) / _this2.camera.zoom, 7);\n        }\n\n        handle.scale.set(1, 1, 1).multiplyScalar(factor * _this2.size / 7); // TODO: simplify helpers and consider decoupling from gizmo\n\n        if (handle.tag === 'helper') {\n          handle.visible = false;\n\n          if (handle.name === 'AXIS') {\n            handle.position.copy(_this2.worldPositionStart);\n            handle.visible = !!_this2.axis;\n\n            if (_this2.axis === 'X') {\n              _this2.tempQuaternion.setFromEuler(_this2.tempEuler.set(0, 0, 0));\n\n              handle.quaternion.copy(quaternion).multiply(_this2.tempQuaternion);\n\n              if (Math.abs(_this2.alignVector.copy(_this2.unitX).applyQuaternion(quaternion).dot(_this2.eye)) > 0.9) {\n                handle.visible = false;\n              }\n            }\n\n            if (_this2.axis === 'Y') {\n              _this2.tempQuaternion.setFromEuler(_this2.tempEuler.set(0, 0, Math.PI / 2));\n\n              handle.quaternion.copy(quaternion).multiply(_this2.tempQuaternion);\n\n              if (Math.abs(_this2.alignVector.copy(_this2.unitY).applyQuaternion(quaternion).dot(_this2.eye)) > 0.9) {\n                handle.visible = false;\n              }\n            }\n\n            if (_this2.axis === 'Z') {\n              _this2.tempQuaternion.setFromEuler(_this2.tempEuler.set(0, Math.PI / 2, 0));\n\n              handle.quaternion.copy(quaternion).multiply(_this2.tempQuaternion);\n\n              if (Math.abs(_this2.alignVector.copy(_this2.unitZ).applyQuaternion(quaternion).dot(_this2.eye)) > 0.9) {\n                handle.visible = false;\n              }\n            }\n\n            if (_this2.axis === 'XYZE') {\n              _this2.tempQuaternion.setFromEuler(_this2.tempEuler.set(0, Math.PI / 2, 0));\n\n              _this2.alignVector.copy(_this2.rotationAxis);\n\n              handle.quaternion.setFromRotationMatrix(_this2.lookAtMatrix.lookAt(_this2.zeroVector, _this2.alignVector, _this2.unitY));\n              handle.quaternion.multiply(_this2.tempQuaternion);\n              handle.visible = _this2.dragging;\n            }\n\n            if (_this2.axis === 'E') {\n              handle.visible = false;\n            }\n          } else if (handle.name === 'START') {\n            handle.position.copy(_this2.worldPositionStart);\n            handle.visible = _this2.dragging;\n          } else if (handle.name === 'END') {\n            handle.position.copy(_this2.worldPosition);\n            handle.visible = _this2.dragging;\n          } else if (handle.name === 'DELTA') {\n            handle.position.copy(_this2.worldPositionStart);\n            handle.quaternion.copy(_this2.worldQuaternionStart);\n\n            _this2.tempVector.set(1e-10, 1e-10, 1e-10).add(_this2.worldPositionStart).sub(_this2.worldPosition).multiplyScalar(-1);\n\n            _this2.tempVector.applyQuaternion(_this2.worldQuaternionStart.clone().invert());\n\n            handle.scale.copy(_this2.tempVector);\n            handle.visible = _this2.dragging;\n          } else {\n            handle.quaternion.copy(quaternion);\n\n            if (_this2.dragging) {\n              handle.position.copy(_this2.worldPositionStart);\n            } else {\n              handle.position.copy(_this2.worldPosition);\n            }\n\n            if (_this2.axis) {\n              handle.visible = _this2.axis.search(handle.name) !== -1;\n            }\n          } // If updating helper, skip rest of the loop\n\n\n          return \"continue\";\n        } // Align handles to current local or world rotation\n\n\n        handle.quaternion.copy(quaternion);\n\n        if (_this2.mode === 'translate' || _this2.mode === 'scale') {\n          // Hide translate and scale axis facing the camera\n          var AXIS_HIDE_TRESHOLD = 0.99;\n          var PLANE_HIDE_TRESHOLD = 0.2;\n          var AXIS_FLIP_TRESHOLD = 0.0;\n\n          if (handle.name === 'X' || handle.name === 'XYZX') {\n            if (Math.abs(_this2.alignVector.copy(_this2.unitX).applyQuaternion(quaternion).dot(_this2.eye)) > AXIS_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n\n          if (handle.name === 'Y' || handle.name === 'XYZY') {\n            if (Math.abs(_this2.alignVector.copy(_this2.unitY).applyQuaternion(quaternion).dot(_this2.eye)) > AXIS_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n\n          if (handle.name === 'Z' || handle.name === 'XYZZ') {\n            if (Math.abs(_this2.alignVector.copy(_this2.unitZ).applyQuaternion(quaternion).dot(_this2.eye)) > AXIS_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n\n          if (handle.name === 'XY') {\n            if (Math.abs(_this2.alignVector.copy(_this2.unitZ).applyQuaternion(quaternion).dot(_this2.eye)) < PLANE_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n\n          if (handle.name === 'YZ') {\n            if (Math.abs(_this2.alignVector.copy(_this2.unitX).applyQuaternion(quaternion).dot(_this2.eye)) < PLANE_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          }\n\n          if (handle.name === 'XZ') {\n            if (Math.abs(_this2.alignVector.copy(_this2.unitY).applyQuaternion(quaternion).dot(_this2.eye)) < PLANE_HIDE_TRESHOLD) {\n              handle.scale.set(1e-10, 1e-10, 1e-10);\n              handle.visible = false;\n            }\n          } // Flip translate and scale axis ocluded behind another axis\n\n\n          if (handle.name.search('X') !== -1) {\n            if (_this2.alignVector.copy(_this2.unitX).applyQuaternion(quaternion).dot(_this2.eye) < AXIS_FLIP_TRESHOLD) {\n              if (handle.tag === 'fwd') {\n                handle.visible = false;\n              } else {\n                handle.scale.x *= -1;\n              }\n            } else if (handle.tag === 'bwd') {\n              handle.visible = false;\n            }\n          }\n\n          if (handle.name.search('Y') !== -1) {\n            if (_this2.alignVector.copy(_this2.unitY).applyQuaternion(quaternion).dot(_this2.eye) < AXIS_FLIP_TRESHOLD) {\n              if (handle.tag === 'fwd') {\n                handle.visible = false;\n              } else {\n                handle.scale.y *= -1;\n              }\n            } else if (handle.tag === 'bwd') {\n              handle.visible = false;\n            }\n          }\n\n          if (handle.name.search('Z') !== -1) {\n            if (_this2.alignVector.copy(_this2.unitZ).applyQuaternion(quaternion).dot(_this2.eye) < AXIS_FLIP_TRESHOLD) {\n              if (handle.tag === 'fwd') {\n                handle.visible = false;\n              } else {\n                handle.scale.z *= -1;\n              }\n            } else if (handle.tag === 'bwd') {\n              handle.visible = false;\n            }\n          }\n        } else if (_this2.mode === 'rotate') {\n          // Align handles to current local or world rotation\n          _this2.tempQuaternion2.copy(quaternion);\n\n          _this2.alignVector.copy(_this2.eye).applyQuaternion(_this2.tempQuaternion.copy(quaternion).invert());\n\n          if (handle.name.search('E') !== -1) {\n            handle.quaternion.setFromRotationMatrix(_this2.lookAtMatrix.lookAt(_this2.eye, _this2.zeroVector, _this2.unitY));\n          }\n\n          if (handle.name === 'X') {\n            _this2.tempQuaternion.setFromAxisAngle(_this2.unitX, Math.atan2(-_this2.alignVector.y, _this2.alignVector.z));\n\n            _this2.tempQuaternion.multiplyQuaternions(_this2.tempQuaternion2, _this2.tempQuaternion);\n\n            handle.quaternion.copy(_this2.tempQuaternion);\n          }\n\n          if (handle.name === 'Y') {\n            _this2.tempQuaternion.setFromAxisAngle(_this2.unitY, Math.atan2(_this2.alignVector.x, _this2.alignVector.z));\n\n            _this2.tempQuaternion.multiplyQuaternions(_this2.tempQuaternion2, _this2.tempQuaternion);\n\n            handle.quaternion.copy(_this2.tempQuaternion);\n          }\n\n          if (handle.name === 'Z') {\n            _this2.tempQuaternion.setFromAxisAngle(_this2.unitZ, Math.atan2(_this2.alignVector.y, _this2.alignVector.x));\n\n            _this2.tempQuaternion.multiplyQuaternions(_this2.tempQuaternion2, _this2.tempQuaternion);\n\n            handle.quaternion.copy(_this2.tempQuaternion);\n          }\n        } // Hide disabled axes\n\n\n        handle.visible = handle.visible && (handle.name.indexOf('X') === -1 || _this2.showX);\n        handle.visible = handle.visible && (handle.name.indexOf('Y') === -1 || _this2.showY);\n        handle.visible = handle.visible && (handle.name.indexOf('Z') === -1 || _this2.showZ);\n        handle.visible = handle.visible && (handle.name.indexOf('E') === -1 || _this2.showX && _this2.showY && _this2.showZ); // highlight selected axis\n        //@ts-ignore\n\n        handle.material.tempOpacity = handle.material.tempOpacity || handle.material.opacity; //@ts-ignore\n\n        handle.material.tempColor = handle.material.tempColor || handle.material.color.clone(); //@ts-ignore\n\n        handle.material.color.copy(handle.material.tempColor); //@ts-ignore\n\n        handle.material.opacity = handle.material.tempOpacity;\n\n        if (!_this2.enabled) {\n          //@ts-ignore\n          handle.material.opacity *= 0.5; //@ts-ignore\n\n          handle.material.color.lerp(new Color(1, 1, 1), 0.5);\n        } else if (_this2.axis) {\n          if (handle.name === _this2.axis) {\n            //@ts-ignore\n            handle.material.opacity = 1.0; //@ts-ignore\n\n            handle.material.color.lerp(new Color(1, 1, 1), 0.5);\n          } else if (_this2.axis.split('').some(function (a) {\n            return handle.name === a;\n          })) {\n            //@ts-ignore\n            handle.material.opacity = 1.0; //@ts-ignore\n\n            handle.material.color.lerp(new Color(1, 1, 1), 0.5);\n          } else {\n            //@ts-ignore\n            handle.material.opacity *= 0.25; //@ts-ignore\n\n            handle.material.color.lerp(new Color(1, 1, 1), 0.5);\n          }\n        }\n      };\n\n      for (var i = 0; i < handles.length; i++) {\n        var _ret = _loop(i);\n\n        if (_ret === \"continue\") continue;\n      }\n\n      _get((_thisSuper2 = _assertThisInitialized(_this2), _getPrototypeOf(TransformControlsGizmo.prototype)), \"updateMatrixWorld\", _thisSuper2).call(_thisSuper2);\n    });\n\n    var gizmoMaterial = new MeshBasicMaterial({\n      depthTest: false,\n      depthWrite: false,\n      transparent: true,\n      side: DoubleSide,\n      fog: false,\n      toneMapped: false\n    });\n    var gizmoLineMaterial = new LineBasicMaterial({\n      depthTest: false,\n      depthWrite: false,\n      transparent: true,\n      linewidth: 1,\n      fog: false,\n      toneMapped: false\n    }); // Make unique material for each axis/color\n\n    var matInvisible = gizmoMaterial.clone();\n    matInvisible.opacity = 0.15;\n    var matHelper = gizmoMaterial.clone();\n    matHelper.opacity = 0.33;\n    var matRed = gizmoMaterial.clone();\n    matRed.color.set(0xff0000);\n    var matGreen = gizmoMaterial.clone();\n    matGreen.color.set(0x00ff00);\n    var matBlue = gizmoMaterial.clone();\n    matBlue.color.set(0x0000ff);\n    var matWhiteTransparent = gizmoMaterial.clone();\n    matWhiteTransparent.opacity = 0.25;\n    var matYellowTransparent = matWhiteTransparent.clone();\n    matYellowTransparent.color.set(0xffff00);\n    var matCyanTransparent = matWhiteTransparent.clone();\n    matCyanTransparent.color.set(0x00ffff);\n    var matMagentaTransparent = matWhiteTransparent.clone();\n    matMagentaTransparent.color.set(0xff00ff);\n    var matYellow = gizmoMaterial.clone();\n    matYellow.color.set(0xffff00);\n    var matLineRed = gizmoLineMaterial.clone();\n    matLineRed.color.set(0xff0000);\n    var matLineGreen = gizmoLineMaterial.clone();\n    matLineGreen.color.set(0x00ff00);\n    var matLineBlue = gizmoLineMaterial.clone();\n    matLineBlue.color.set(0x0000ff);\n    var matLineCyan = gizmoLineMaterial.clone();\n    matLineCyan.color.set(0x00ffff);\n    var matLineMagenta = gizmoLineMaterial.clone();\n    matLineMagenta.color.set(0xff00ff);\n    var matLineYellow = gizmoLineMaterial.clone();\n    matLineYellow.color.set(0xffff00);\n    var matLineGray = gizmoLineMaterial.clone();\n    matLineGray.color.set(0x787878);\n    var matLineYellowTransparent = matLineYellow.clone();\n    matLineYellowTransparent.opacity = 0.25; // reusable geometry\n\n    var arrowGeometry = new CylinderGeometry(0, 0.05, 0.2, 12, 1, false);\n    var scaleHandleGeometry = new BoxGeometry(0.125, 0.125, 0.125);\n    var lineGeometry = new BufferGeometry();\n    lineGeometry.setAttribute('position', new Float32BufferAttribute([0, 0, 0, 1, 0, 0], 3));\n\n    var CircleGeometry = function CircleGeometry(radius, arc) {\n      var geometry = new BufferGeometry();\n      var vertices = [];\n\n      for (var i = 0; i <= 64 * arc; ++i) {\n        vertices.push(0, Math.cos(i / 32 * Math.PI) * radius, Math.sin(i / 32 * Math.PI) * radius);\n      }\n\n      geometry.setAttribute('position', new Float32BufferAttribute(vertices, 3));\n      return geometry;\n    }; // Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\n\n\n    var TranslateHelperGeometry = function TranslateHelperGeometry() {\n      var geometry = new BufferGeometry();\n      geometry.setAttribute('position', new Float32BufferAttribute([0, 0, 0, 1, 1, 1], 3));\n      return geometry;\n    }; // Gizmo definitions - custom hierarchy definitions for setupGizmo() function\n\n\n    var gizmoTranslate = {\n      X: [[new Mesh(arrowGeometry, matRed), [1, 0, 0], [0, 0, -Math.PI / 2], null, 'fwd'], [new Mesh(arrowGeometry, matRed), [1, 0, 0], [0, 0, Math.PI / 2], null, 'bwd'], [new Line(lineGeometry, matLineRed)]],\n      Y: [[new Mesh(arrowGeometry, matGreen), [0, 1, 0], null, null, 'fwd'], [new Mesh(arrowGeometry, matGreen), [0, 1, 0], [Math.PI, 0, 0], null, 'bwd'], [new Line(lineGeometry, matLineGreen), null, [0, 0, Math.PI / 2]]],\n      Z: [[new Mesh(arrowGeometry, matBlue), [0, 0, 1], [Math.PI / 2, 0, 0], null, 'fwd'], [new Mesh(arrowGeometry, matBlue), [0, 0, 1], [-Math.PI / 2, 0, 0], null, 'bwd'], [new Line(lineGeometry, matLineBlue), null, [0, -Math.PI / 2, 0]]],\n      XYZ: [[new Mesh(new OctahedronGeometry(0.1, 0), matWhiteTransparent.clone()), [0, 0, 0], [0, 0, 0]]],\n      XY: [[new Mesh(new PlaneGeometry(0.295, 0.295), matYellowTransparent.clone()), [0.15, 0.15, 0]], [new Line(lineGeometry, matLineYellow), [0.18, 0.3, 0], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineYellow), [0.3, 0.18, 0], [0, 0, Math.PI / 2], [0.125, 1, 1]]],\n      YZ: [[new Mesh(new PlaneGeometry(0.295, 0.295), matCyanTransparent.clone()), [0, 0.15, 0.15], [0, Math.PI / 2, 0]], [new Line(lineGeometry, matLineCyan), [0, 0.18, 0.3], [0, 0, Math.PI / 2], [0.125, 1, 1]], [new Line(lineGeometry, matLineCyan), [0, 0.3, 0.18], [0, -Math.PI / 2, 0], [0.125, 1, 1]]],\n      XZ: [[new Mesh(new PlaneGeometry(0.295, 0.295), matMagentaTransparent.clone()), [0.15, 0, 0.15], [-Math.PI / 2, 0, 0]], [new Line(lineGeometry, matLineMagenta), [0.18, 0, 0.3], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineMagenta), [0.3, 0, 0.18], [0, -Math.PI / 2, 0], [0.125, 1, 1]]]\n    };\n    var pickerTranslate = {\n      X: [[new Mesh(new CylinderGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0.6, 0, 0], [0, 0, -Math.PI / 2]]],\n      Y: [[new Mesh(new CylinderGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0, 0.6, 0]]],\n      Z: [[new Mesh(new CylinderGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0, 0, 0.6], [Math.PI / 2, 0, 0]]],\n      XYZ: [[new Mesh(new OctahedronGeometry(0.2, 0), matInvisible)]],\n      XY: [[new Mesh(new PlaneGeometry(0.4, 0.4), matInvisible), [0.2, 0.2, 0]]],\n      YZ: [[new Mesh(new PlaneGeometry(0.4, 0.4), matInvisible), [0, 0.2, 0.2], [0, Math.PI / 2, 0]]],\n      XZ: [[new Mesh(new PlaneGeometry(0.4, 0.4), matInvisible), [0.2, 0, 0.2], [-Math.PI / 2, 0, 0]]]\n    };\n    var helperTranslate = {\n      START: [[new Mesh(new OctahedronGeometry(0.01, 2), matHelper), null, null, null, 'helper']],\n      END: [[new Mesh(new OctahedronGeometry(0.01, 2), matHelper), null, null, null, 'helper']],\n      DELTA: [[new Line(TranslateHelperGeometry(), matHelper), null, null, null, 'helper']],\n      X: [[new Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], 'helper']],\n      Y: [[new Line(lineGeometry, matHelper.clone()), [0, -1e3, 0], [0, 0, Math.PI / 2], [1e6, 1, 1], 'helper']],\n      Z: [[new Line(lineGeometry, matHelper.clone()), [0, 0, -1e3], [0, -Math.PI / 2, 0], [1e6, 1, 1], 'helper']]\n    };\n    var gizmoRotate = {\n      X: [[new Line(CircleGeometry(1, 0.5), matLineRed)], [new Mesh(new OctahedronGeometry(0.04, 0), matRed), [0, 0, 0.99], null, [1, 3, 1]]],\n      Y: [[new Line(CircleGeometry(1, 0.5), matLineGreen), null, [0, 0, -Math.PI / 2]], [new Mesh(new OctahedronGeometry(0.04, 0), matGreen), [0, 0, 0.99], null, [3, 1, 1]]],\n      Z: [[new Line(CircleGeometry(1, 0.5), matLineBlue), null, [0, Math.PI / 2, 0]], [new Mesh(new OctahedronGeometry(0.04, 0), matBlue), [0.99, 0, 0], null, [1, 3, 1]]],\n      E: [[new Line(CircleGeometry(1.25, 1), matLineYellowTransparent), null, [0, Math.PI / 2, 0]], [new Mesh(new CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [1.17, 0, 0], [0, 0, -Math.PI / 2], [1, 1, 0.001]], [new Mesh(new CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [-1.17, 0, 0], [0, 0, Math.PI / 2], [1, 1, 0.001]], [new Mesh(new CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [0, -1.17, 0], [Math.PI, 0, 0], [1, 1, 0.001]], [new Mesh(new CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [0, 1.17, 0], [0, 0, 0], [1, 1, 0.001]]],\n      XYZE: [[new Line(CircleGeometry(1, 1), matLineGray), null, [0, Math.PI / 2, 0]]]\n    };\n    var helperRotate = {\n      AXIS: [[new Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], 'helper']]\n    };\n    var pickerRotate = {\n      X: [[new Mesh(new TorusGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [0, -Math.PI / 2, -Math.PI / 2]]],\n      Y: [[new Mesh(new TorusGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [Math.PI / 2, 0, 0]]],\n      Z: [[new Mesh(new TorusGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [0, 0, -Math.PI / 2]]],\n      E: [[new Mesh(new TorusGeometry(1.25, 0.1, 2, 24), matInvisible)]],\n      XYZE: [[new Mesh(new SphereGeometry(0.7, 10, 8), matInvisible)]]\n    };\n    var gizmoScale = {\n      X: [[new Mesh(scaleHandleGeometry, matRed), [0.8, 0, 0], [0, 0, -Math.PI / 2]], [new Line(lineGeometry, matLineRed), null, null, [0.8, 1, 1]]],\n      Y: [[new Mesh(scaleHandleGeometry, matGreen), [0, 0.8, 0]], [new Line(lineGeometry, matLineGreen), null, [0, 0, Math.PI / 2], [0.8, 1, 1]]],\n      Z: [[new Mesh(scaleHandleGeometry, matBlue), [0, 0, 0.8], [Math.PI / 2, 0, 0]], [new Line(lineGeometry, matLineBlue), null, [0, -Math.PI / 2, 0], [0.8, 1, 1]]],\n      XY: [[new Mesh(scaleHandleGeometry, matYellowTransparent), [0.85, 0.85, 0], null, [2, 2, 0.2]], [new Line(lineGeometry, matLineYellow), [0.855, 0.98, 0], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineYellow), [0.98, 0.855, 0], [0, 0, Math.PI / 2], [0.125, 1, 1]]],\n      YZ: [[new Mesh(scaleHandleGeometry, matCyanTransparent), [0, 0.85, 0.85], null, [0.2, 2, 2]], [new Line(lineGeometry, matLineCyan), [0, 0.855, 0.98], [0, 0, Math.PI / 2], [0.125, 1, 1]], [new Line(lineGeometry, matLineCyan), [0, 0.98, 0.855], [0, -Math.PI / 2, 0], [0.125, 1, 1]]],\n      XZ: [[new Mesh(scaleHandleGeometry, matMagentaTransparent), [0.85, 0, 0.85], null, [2, 0.2, 2]], [new Line(lineGeometry, matLineMagenta), [0.855, 0, 0.98], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineMagenta), [0.98, 0, 0.855], [0, -Math.PI / 2, 0], [0.125, 1, 1]]],\n      XYZX: [[new Mesh(new BoxGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [1.1, 0, 0]]],\n      XYZY: [[new Mesh(new BoxGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [0, 1.1, 0]]],\n      XYZZ: [[new Mesh(new BoxGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [0, 0, 1.1]]]\n    };\n    var pickerScale = {\n      X: [[new Mesh(new CylinderGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0.5, 0, 0], [0, 0, -Math.PI / 2]]],\n      Y: [[new Mesh(new CylinderGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0, 0.5, 0]]],\n      Z: [[new Mesh(new CylinderGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0, 0, 0.5], [Math.PI / 2, 0, 0]]],\n      XY: [[new Mesh(scaleHandleGeometry, matInvisible), [0.85, 0.85, 0], null, [3, 3, 0.2]]],\n      YZ: [[new Mesh(scaleHandleGeometry, matInvisible), [0, 0.85, 0.85], null, [0.2, 3, 3]]],\n      XZ: [[new Mesh(scaleHandleGeometry, matInvisible), [0.85, 0, 0.85], null, [3, 0.2, 3]]],\n      XYZX: [[new Mesh(new BoxGeometry(0.2, 0.2, 0.2), matInvisible), [1.1, 0, 0]]],\n      XYZY: [[new Mesh(new BoxGeometry(0.2, 0.2, 0.2), matInvisible), [0, 1.1, 0]]],\n      XYZZ: [[new Mesh(new BoxGeometry(0.2, 0.2, 0.2), matInvisible), [0, 0, 1.1]]]\n    };\n    var helperScale = {\n      X: [[new Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], 'helper']],\n      Y: [[new Line(lineGeometry, matHelper.clone()), [0, -1e3, 0], [0, 0, Math.PI / 2], [1e6, 1, 1], 'helper']],\n      Z: [[new Line(lineGeometry, matHelper.clone()), [0, 0, -1e3], [0, -Math.PI / 2, 0], [1e6, 1, 1], 'helper']]\n    }; // Creates an Object3D with gizmos described in custom hierarchy definition.\n    // this is nearly impossible to Type so i'm leaving it\n\n    var setupGizmo = function setupGizmo(gizmoMap) {\n      var gizmo = new Object3D();\n\n      for (var name in gizmoMap) {\n        for (var i = gizmoMap[name].length; i--;) {\n          var object = gizmoMap[name][i][0].clone();\n          var position = gizmoMap[name][i][1];\n          var rotation = gizmoMap[name][i][2];\n          var scale = gizmoMap[name][i][3];\n          var tag = gizmoMap[name][i][4]; // name and tag properties are essential for picking and updating logic.\n\n          object.name = name; // @ts-ignore\n\n          object.tag = tag;\n\n          if (position) {\n            object.position.set(position[0], position[1], position[2]);\n          }\n\n          if (rotation) {\n            object.rotation.set(rotation[0], rotation[1], rotation[2]);\n          }\n\n          if (scale) {\n            object.scale.set(scale[0], scale[1], scale[2]);\n          }\n\n          object.updateMatrix();\n          var tempGeometry = object.geometry.clone();\n          tempGeometry.applyMatrix4(object.matrix);\n          object.geometry = tempGeometry;\n          object.renderOrder = Infinity;\n          object.position.set(0, 0, 0);\n          object.rotation.set(0, 0, 0);\n          object.scale.set(1, 1, 1);\n          gizmo.add(object);\n        }\n      }\n\n      return gizmo;\n    };\n\n    _this2.gizmo = {};\n    _this2.picker = {};\n    _this2.helper = {};\n\n    _this2.add(_this2.gizmo['translate'] = setupGizmo(gizmoTranslate));\n\n    _this2.add(_this2.gizmo['rotate'] = setupGizmo(gizmoRotate));\n\n    _this2.add(_this2.gizmo['scale'] = setupGizmo(gizmoScale));\n\n    _this2.add(_this2.picker['translate'] = setupGizmo(pickerTranslate));\n\n    _this2.add(_this2.picker['rotate'] = setupGizmo(pickerRotate));\n\n    _this2.add(_this2.picker['scale'] = setupGizmo(pickerScale));\n\n    _this2.add(_this2.helper['translate'] = setupGizmo(helperTranslate));\n\n    _this2.add(_this2.helper['rotate'] = setupGizmo(helperRotate));\n\n    _this2.add(_this2.helper['scale'] = setupGizmo(helperScale)); // Pickers should be hidden always\n\n\n    _this2.picker['translate'].visible = false;\n    _this2.picker['rotate'].visible = false;\n    _this2.picker['scale'].visible = false;\n    return _this2;\n  } // updateMatrixWorld will update transformations and appearance of individual handles\n\n\n  return _createClass(TransformControlsGizmo);\n}(Object3D);\n\nvar TransformControlsPlane = /*#__PURE__*/function (_Mesh) {\n  _inherits(TransformControlsPlane, _Mesh);\n\n  var _super3 = _createSuper(TransformControlsPlane);\n\n  function TransformControlsPlane() {\n    var _thisSuper3, _this3;\n\n    _classCallCheck(this, TransformControlsPlane);\n\n    _this3 = _super3.call(this, new PlaneGeometry(100000, 100000, 2, 2), new MeshBasicMaterial({\n      visible: false,\n      wireframe: true,\n      side: DoubleSide,\n      transparent: true,\n      opacity: 0.1,\n      toneMapped: false\n    }));\n\n    _defineProperty(_assertThisInitialized(_this3), \"isTransformControlsPlane\", true);\n\n    _defineProperty(_assertThisInitialized(_this3), \"type\", 'TransformControlsPlane');\n\n    _defineProperty(_assertThisInitialized(_this3), \"unitX\", new Vector3(1, 0, 0));\n\n    _defineProperty(_assertThisInitialized(_this3), \"unitY\", new Vector3(0, 1, 0));\n\n    _defineProperty(_assertThisInitialized(_this3), \"unitZ\", new Vector3(0, 0, 1));\n\n    _defineProperty(_assertThisInitialized(_this3), \"tempVector\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this3), \"dirVector\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this3), \"alignVector\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this3), \"tempMatrix\", new Matrix4());\n\n    _defineProperty(_assertThisInitialized(_this3), \"identityQuaternion\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this3), \"cameraQuaternion\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this3), \"worldPosition\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this3), \"worldQuaternion\", new Quaternion());\n\n    _defineProperty(_assertThisInitialized(_this3), \"eye\", new Vector3());\n\n    _defineProperty(_assertThisInitialized(_this3), \"axis\", null);\n\n    _defineProperty(_assertThisInitialized(_this3), \"mode\", 'translate');\n\n    _defineProperty(_assertThisInitialized(_this3), \"space\", 'world');\n\n    _defineProperty(_assertThisInitialized(_this3), \"updateMatrixWorld\", function () {\n      var space = _this3.space;\n\n      _this3.position.copy(_this3.worldPosition);\n\n      if (_this3.mode === 'scale') space = 'local'; // scale always oriented to local rotation\n\n      _this3.unitX.set(1, 0, 0).applyQuaternion(space === 'local' ? _this3.worldQuaternion : _this3.identityQuaternion);\n\n      _this3.unitY.set(0, 1, 0).applyQuaternion(space === 'local' ? _this3.worldQuaternion : _this3.identityQuaternion);\n\n      _this3.unitZ.set(0, 0, 1).applyQuaternion(space === 'local' ? _this3.worldQuaternion : _this3.identityQuaternion); // Align the plane for current transform mode, axis and space.\n\n\n      _this3.alignVector.copy(_this3.unitY);\n\n      switch (_this3.mode) {\n        case 'translate':\n        case 'scale':\n          switch (_this3.axis) {\n            case 'X':\n              _this3.alignVector.copy(_this3.eye).cross(_this3.unitX);\n\n              _this3.dirVector.copy(_this3.unitX).cross(_this3.alignVector);\n\n              break;\n\n            case 'Y':\n              _this3.alignVector.copy(_this3.eye).cross(_this3.unitY);\n\n              _this3.dirVector.copy(_this3.unitY).cross(_this3.alignVector);\n\n              break;\n\n            case 'Z':\n              _this3.alignVector.copy(_this3.eye).cross(_this3.unitZ);\n\n              _this3.dirVector.copy(_this3.unitZ).cross(_this3.alignVector);\n\n              break;\n\n            case 'XY':\n              _this3.dirVector.copy(_this3.unitZ);\n\n              break;\n\n            case 'YZ':\n              _this3.dirVector.copy(_this3.unitX);\n\n              break;\n\n            case 'XZ':\n              _this3.alignVector.copy(_this3.unitZ);\n\n              _this3.dirVector.copy(_this3.unitY);\n\n              break;\n\n            case 'XYZ':\n            case 'E':\n              _this3.dirVector.set(0, 0, 0);\n\n              break;\n          }\n\n          break;\n\n        case 'rotate':\n        default:\n          // special case for rotate\n          _this3.dirVector.set(0, 0, 0);\n\n      }\n\n      if (_this3.dirVector.length() === 0) {\n        // If in rotate mode, make the plane parallel to camera\n        _this3.quaternion.copy(_this3.cameraQuaternion);\n      } else {\n        _this3.tempMatrix.lookAt(_this3.tempVector.set(0, 0, 0), _this3.dirVector, _this3.alignVector);\n\n        _this3.quaternion.setFromRotationMatrix(_this3.tempMatrix);\n      }\n\n      _get((_thisSuper3 = _assertThisInitialized(_this3), _getPrototypeOf(TransformControlsPlane.prototype)), \"updateMatrixWorld\", _thisSuper3).call(_thisSuper3);\n    });\n\n    return _this3;\n  }\n\n  return _createClass(TransformControlsPlane);\n}(Mesh);\n\nexport { TransformControls, TransformControlsGizmo, TransformControlsPlane };","map":{"version":3,"names":["_defineProperty","Object3D","Raycaster","Vector3","Quaternion","Euler","Matrix4","Color","MeshBasicMaterial","DoubleSide","LineBasicMaterial","CylinderGeometry","BoxGeometry","BufferGeometry","Float32BufferAttribute","Mesh","Line","OctahedronGeometry","PlaneGeometry","TorusGeometry","SphereGeometry","TransformControls","camera","_domElement","X","Y","Z","type","mode","object","raycaster","includeInvisible","allIntersections","intersectObject","i","length","visible","undefined","axis","enabled","dragging","position","copy","positionStart","quaternion","quaternionStart","scale","scaleStart","dispatchEvent","changeEvent","objectChangeEvent","pointStart","pointEnd","updateMatrixWorld","parent","console","error","matrixWorld","decompose","parentPosition","parentQuaternion","parentScale","worldPosition","worldQuaternion","worldScale","parentQuaternionInv","invert","worldQuaternionInv","cameraPosition","cameraQuaternion","cameraScale","eye","sub","normalize","pointer","setFromCamera","intersect","intersectObjectWithRay","gizmo","picker","name","button","planeIntersect","plane","space","snap","rotationSnap","rotation","x","Math","round","y","z","worldPositionStart","worldQuaternionStart","worldScaleStart","point","mouseDownEvent","offset","applyQuaternion","indexOf","divide","add","translationSnap","tempQuaternion","search","tempVector","setFromMatrixPosition","d","dot","tempVector2","set","multiply","scaleSnap","ROTATION_SPEED","distanceTo","rotationAxis","rotationAngle","angleTo","startNorm","endNorm","cross","unit","setFromAxisAngle","mouseUpEvent","event","_this$domElement$owne","domElement","ownerDocument","pointerLockElement","_this$domElement","changedTouches","rect","getBoundingClientRect","clientX","left","width","clientY","top","height","pointerType","pointerHover","getPointer","style","touchAction","addEventListener","onPointerMove","pointerDown","pointerMove","removeEventListener","pointerUp","size","warn","document","onPointerDown","onPointerHover","onPointerUp","_this$domElement2","_this$domElement3","_this$domElement4","_this$domElement4$own","_this$domElement5","_this$domElement5$own","traverse","child","mesh","geometry","dispose","material","TransformControlsGizmo","TransformControlsPlane","defineProperty","propName","defaultValue","propValue","Object","get","value","showX","showY","showZ","connect","identityQuaternion","helper","handles","concat","children","handle","factor","isOrthographicCamera","bottom","zoom","min","tan","PI","fov","multiplyScalar","tag","setFromEuler","tempEuler","abs","alignVector","unitX","unitY","unitZ","setFromRotationMatrix","lookAtMatrix","lookAt","zeroVector","clone","AXIS_HIDE_TRESHOLD","PLANE_HIDE_TRESHOLD","AXIS_FLIP_TRESHOLD","tempQuaternion2","atan2","multiplyQuaternions","tempOpacity","opacity","tempColor","color","lerp","split","some","a","gizmoMaterial","depthTest","depthWrite","transparent","side","fog","toneMapped","gizmoLineMaterial","linewidth","matInvisible","matHelper","matRed","matGreen","matBlue","matWhiteTransparent","matYellowTransparent","matCyanTransparent","matMagentaTransparent","matYellow","matLineRed","matLineGreen","matLineBlue","matLineCyan","matLineMagenta","matLineYellow","matLineGray","matLineYellowTransparent","arrowGeometry","scaleHandleGeometry","lineGeometry","setAttribute","CircleGeometry","radius","arc","vertices","push","cos","sin","TranslateHelperGeometry","gizmoTranslate","XYZ","XY","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","gizmoRotate","E","XYZE","helperRotate","AXIS","pickerRotate","gizmoScale","XYZX","XYZY","XYZZ","pickerScale","helperScale","setupGizmo","gizmoMap","updateMatrix","tempGeometry","applyMatrix4","matrix","renderOrder","Infinity","wireframe","dirVector","tempMatrix"],"sources":["D:/Github/NIKE-DJANGO/Jord/l4fycy/node_modules/three-stdlib/controls/TransformControls.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\r\nimport { Object3D, Raycaster, Vector3, Quaternion, Euler, Matrix4, Color, MeshBasicMaterial, DoubleSide, LineBasicMaterial, CylinderGeometry, BoxGeometry, BufferGeometry, Float32BufferAttribute, Mesh, Line, OctahedronGeometry, PlaneGeometry, TorusGeometry, SphereGeometry } from 'three';\r\n\r\nclass TransformControls extends Object3D {\r\n  // events\r\n  constructor(camera, _domElement) {\r\n    super();\r\n\r\n    _defineProperty(this, \"isTransformControls\", true);\r\n\r\n    _defineProperty(this, \"visible\", false);\r\n\r\n    _defineProperty(this, \"domElement\", void 0);\r\n\r\n    _defineProperty(this, \"raycaster\", new Raycaster());\r\n\r\n    _defineProperty(this, \"gizmo\", void 0);\r\n\r\n    _defineProperty(this, \"plane\", void 0);\r\n\r\n    _defineProperty(this, \"tempVector\", new Vector3());\r\n\r\n    _defineProperty(this, \"tempVector2\", new Vector3());\r\n\r\n    _defineProperty(this, \"tempQuaternion\", new Quaternion());\r\n\r\n    _defineProperty(this, \"unit\", {\r\n      X: new Vector3(1, 0, 0),\r\n      Y: new Vector3(0, 1, 0),\r\n      Z: new Vector3(0, 0, 1)\r\n    });\r\n\r\n    _defineProperty(this, \"pointStart\", new Vector3());\r\n\r\n    _defineProperty(this, \"pointEnd\", new Vector3());\r\n\r\n    _defineProperty(this, \"offset\", new Vector3());\r\n\r\n    _defineProperty(this, \"rotationAxis\", new Vector3());\r\n\r\n    _defineProperty(this, \"startNorm\", new Vector3());\r\n\r\n    _defineProperty(this, \"endNorm\", new Vector3());\r\n\r\n    _defineProperty(this, \"rotationAngle\", 0);\r\n\r\n    _defineProperty(this, \"cameraPosition\", new Vector3());\r\n\r\n    _defineProperty(this, \"cameraQuaternion\", new Quaternion());\r\n\r\n    _defineProperty(this, \"cameraScale\", new Vector3());\r\n\r\n    _defineProperty(this, \"parentPosition\", new Vector3());\r\n\r\n    _defineProperty(this, \"parentQuaternion\", new Quaternion());\r\n\r\n    _defineProperty(this, \"parentQuaternionInv\", new Quaternion());\r\n\r\n    _defineProperty(this, \"parentScale\", new Vector3());\r\n\r\n    _defineProperty(this, \"worldPositionStart\", new Vector3());\r\n\r\n    _defineProperty(this, \"worldQuaternionStart\", new Quaternion());\r\n\r\n    _defineProperty(this, \"worldScaleStart\", new Vector3());\r\n\r\n    _defineProperty(this, \"worldPosition\", new Vector3());\r\n\r\n    _defineProperty(this, \"worldQuaternion\", new Quaternion());\r\n\r\n    _defineProperty(this, \"worldQuaternionInv\", new Quaternion());\r\n\r\n    _defineProperty(this, \"worldScale\", new Vector3());\r\n\r\n    _defineProperty(this, \"eye\", new Vector3());\r\n\r\n    _defineProperty(this, \"positionStart\", new Vector3());\r\n\r\n    _defineProperty(this, \"quaternionStart\", new Quaternion());\r\n\r\n    _defineProperty(this, \"scaleStart\", new Vector3());\r\n\r\n    _defineProperty(this, \"camera\", void 0);\r\n\r\n    _defineProperty(this, \"object\", void 0);\r\n\r\n    _defineProperty(this, \"enabled\", true);\r\n\r\n    _defineProperty(this, \"axis\", null);\r\n\r\n    _defineProperty(this, \"mode\", 'translate');\r\n\r\n    _defineProperty(this, \"translationSnap\", null);\r\n\r\n    _defineProperty(this, \"rotationSnap\", null);\r\n\r\n    _defineProperty(this, \"scaleSnap\", null);\r\n\r\n    _defineProperty(this, \"space\", 'world');\r\n\r\n    _defineProperty(this, \"size\", 1);\r\n\r\n    _defineProperty(this, \"dragging\", false);\r\n\r\n    _defineProperty(this, \"showX\", true);\r\n\r\n    _defineProperty(this, \"showY\", true);\r\n\r\n    _defineProperty(this, \"showZ\", true);\r\n\r\n    _defineProperty(this, \"changeEvent\", {\r\n      type: 'change'\r\n    });\r\n\r\n    _defineProperty(this, \"mouseDownEvent\", {\r\n      type: 'mouseDown',\r\n      mode: this.mode\r\n    });\r\n\r\n    _defineProperty(this, \"mouseUpEvent\", {\r\n      type: 'mouseUp',\r\n      mode: this.mode\r\n    });\r\n\r\n    _defineProperty(this, \"objectChangeEvent\", {\r\n      type: 'objectChange'\r\n    });\r\n\r\n    _defineProperty(this, \"intersectObjectWithRay\", (object, raycaster, includeInvisible) => {\r\n      const allIntersections = raycaster.intersectObject(object, true);\r\n\r\n      for (let i = 0; i < allIntersections.length; i++) {\r\n        if (allIntersections[i].object.visible || includeInvisible) {\r\n          return allIntersections[i];\r\n        }\r\n      }\r\n\r\n      return false;\r\n    });\r\n\r\n    _defineProperty(this, \"attach\", object => {\r\n      this.object = object;\r\n      this.visible = true;\r\n      return this;\r\n    });\r\n\r\n    _defineProperty(this, \"detach\", () => {\r\n      this.object = undefined;\r\n      this.visible = false;\r\n      this.axis = null;\r\n      return this;\r\n    });\r\n\r\n    _defineProperty(this, \"reset\", () => {\r\n      if (!this.enabled) return this;\r\n\r\n      if (this.dragging) {\r\n        if (this.object !== undefined) {\r\n          this.object.position.copy(this.positionStart);\r\n          this.object.quaternion.copy(this.quaternionStart);\r\n          this.object.scale.copy(this.scaleStart);\r\n          this.dispatchEvent(this.changeEvent);\r\n          this.dispatchEvent(this.objectChangeEvent);\r\n          this.pointStart.copy(this.pointEnd);\r\n        }\r\n      }\r\n\r\n      return this;\r\n    });\r\n\r\n    _defineProperty(this, \"updateMatrixWorld\", () => {\r\n      if (this.object !== undefined) {\r\n        this.object.updateMatrixWorld();\r\n\r\n        if (this.object.parent === null) {\r\n          console.error('TransformControls: The attached 3D object must be a part of the scene graph.');\r\n        } else {\r\n          this.object.parent.matrixWorld.decompose(this.parentPosition, this.parentQuaternion, this.parentScale);\r\n        }\r\n\r\n        this.object.matrixWorld.decompose(this.worldPosition, this.worldQuaternion, this.worldScale);\r\n        this.parentQuaternionInv.copy(this.parentQuaternion).invert();\r\n        this.worldQuaternionInv.copy(this.worldQuaternion).invert();\r\n      }\r\n\r\n      this.camera.updateMatrixWorld();\r\n      this.camera.matrixWorld.decompose(this.cameraPosition, this.cameraQuaternion, this.cameraScale);\r\n      this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize();\r\n      super.updateMatrixWorld();\r\n    });\r\n\r\n    _defineProperty(this, \"pointerHover\", pointer => {\r\n      if (this.object === undefined || this.dragging === true) return;\r\n      this.raycaster.setFromCamera(pointer, this.camera);\r\n      const intersect = this.intersectObjectWithRay(this.gizmo.picker[this.mode], this.raycaster);\r\n\r\n      if (intersect) {\r\n        this.axis = intersect.object.name;\r\n      } else {\r\n        this.axis = null;\r\n      }\r\n    });\r\n\r\n    _defineProperty(this, \"pointerDown\", pointer => {\r\n      if (this.object === undefined || this.dragging === true || pointer.button !== 0) return;\r\n\r\n      if (this.axis !== null) {\r\n        this.raycaster.setFromCamera(pointer, this.camera);\r\n        const planeIntersect = this.intersectObjectWithRay(this.plane, this.raycaster, true);\r\n\r\n        if (planeIntersect) {\r\n          let space = this.space;\r\n\r\n          if (this.mode === 'scale') {\r\n            space = 'local';\r\n          } else if (this.axis === 'E' || this.axis === 'XYZE' || this.axis === 'XYZ') {\r\n            space = 'world';\r\n          }\r\n\r\n          if (space === 'local' && this.mode === 'rotate') {\r\n            const snap = this.rotationSnap;\r\n            if (this.axis === 'X' && snap) this.object.rotation.x = Math.round(this.object.rotation.x / snap) * snap;\r\n            if (this.axis === 'Y' && snap) this.object.rotation.y = Math.round(this.object.rotation.y / snap) * snap;\r\n            if (this.axis === 'Z' && snap) this.object.rotation.z = Math.round(this.object.rotation.z / snap) * snap;\r\n          }\r\n\r\n          this.object.updateMatrixWorld();\r\n\r\n          if (this.object.parent) {\r\n            this.object.parent.updateMatrixWorld();\r\n          }\r\n\r\n          this.positionStart.copy(this.object.position);\r\n          this.quaternionStart.copy(this.object.quaternion);\r\n          this.scaleStart.copy(this.object.scale);\r\n          this.object.matrixWorld.decompose(this.worldPositionStart, this.worldQuaternionStart, this.worldScaleStart);\r\n          this.pointStart.copy(planeIntersect.point).sub(this.worldPositionStart);\r\n        }\r\n\r\n        this.dragging = true;\r\n        this.mouseDownEvent.mode = this.mode;\r\n        this.dispatchEvent(this.mouseDownEvent);\r\n      }\r\n    });\r\n\r\n    _defineProperty(this, \"pointerMove\", pointer => {\r\n      const axis = this.axis;\r\n      const mode = this.mode;\r\n      const object = this.object;\r\n      let space = this.space;\r\n\r\n      if (mode === 'scale') {\r\n        space = 'local';\r\n      } else if (axis === 'E' || axis === 'XYZE' || axis === 'XYZ') {\r\n        space = 'world';\r\n      }\r\n\r\n      if (object === undefined || axis === null || this.dragging === false || pointer.button !== -1) return;\r\n      this.raycaster.setFromCamera(pointer, this.camera);\r\n      const planeIntersect = this.intersectObjectWithRay(this.plane, this.raycaster, true);\r\n      if (!planeIntersect) return;\r\n      this.pointEnd.copy(planeIntersect.point).sub(this.worldPositionStart);\r\n\r\n      if (mode === 'translate') {\r\n        // Apply translate\r\n        this.offset.copy(this.pointEnd).sub(this.pointStart);\r\n\r\n        if (space === 'local' && axis !== 'XYZ') {\r\n          this.offset.applyQuaternion(this.worldQuaternionInv);\r\n        }\r\n\r\n        if (axis.indexOf('X') === -1) this.offset.x = 0;\r\n        if (axis.indexOf('Y') === -1) this.offset.y = 0;\r\n        if (axis.indexOf('Z') === -1) this.offset.z = 0;\r\n\r\n        if (space === 'local' && axis !== 'XYZ') {\r\n          this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale);\r\n        } else {\r\n          this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale);\r\n        }\r\n\r\n        object.position.copy(this.offset).add(this.positionStart); // Apply translation snap\r\n\r\n        if (this.translationSnap) {\r\n          if (space === 'local') {\r\n            object.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert());\r\n\r\n            if (axis.search('X') !== -1) {\r\n              object.position.x = Math.round(object.position.x / this.translationSnap) * this.translationSnap;\r\n            }\r\n\r\n            if (axis.search('Y') !== -1) {\r\n              object.position.y = Math.round(object.position.y / this.translationSnap) * this.translationSnap;\r\n            }\r\n\r\n            if (axis.search('Z') !== -1) {\r\n              object.position.z = Math.round(object.position.z / this.translationSnap) * this.translationSnap;\r\n            }\r\n\r\n            object.position.applyQuaternion(this.quaternionStart);\r\n          }\r\n\r\n          if (space === 'world') {\r\n            if (object.parent) {\r\n              object.position.add(this.tempVector.setFromMatrixPosition(object.parent.matrixWorld));\r\n            }\r\n\r\n            if (axis.search('X') !== -1) {\r\n              object.position.x = Math.round(object.position.x / this.translationSnap) * this.translationSnap;\r\n            }\r\n\r\n            if (axis.search('Y') !== -1) {\r\n              object.position.y = Math.round(object.position.y / this.translationSnap) * this.translationSnap;\r\n            }\r\n\r\n            if (axis.search('Z') !== -1) {\r\n              object.position.z = Math.round(object.position.z / this.translationSnap) * this.translationSnap;\r\n            }\r\n\r\n            if (object.parent) {\r\n              object.position.sub(this.tempVector.setFromMatrixPosition(object.parent.matrixWorld));\r\n            }\r\n          }\r\n        }\r\n      } else if (mode === 'scale') {\r\n        if (axis.search('XYZ') !== -1) {\r\n          let d = this.pointEnd.length() / this.pointStart.length();\r\n          if (this.pointEnd.dot(this.pointStart) < 0) d *= -1;\r\n          this.tempVector2.set(d, d, d);\r\n        } else {\r\n          this.tempVector.copy(this.pointStart);\r\n          this.tempVector2.copy(this.pointEnd);\r\n          this.tempVector.applyQuaternion(this.worldQuaternionInv);\r\n          this.tempVector2.applyQuaternion(this.worldQuaternionInv);\r\n          this.tempVector2.divide(this.tempVector);\r\n\r\n          if (axis.search('X') === -1) {\r\n            this.tempVector2.x = 1;\r\n          }\r\n\r\n          if (axis.search('Y') === -1) {\r\n            this.tempVector2.y = 1;\r\n          }\r\n\r\n          if (axis.search('Z') === -1) {\r\n            this.tempVector2.z = 1;\r\n          }\r\n        } // Apply scale\r\n\r\n\r\n        object.scale.copy(this.scaleStart).multiply(this.tempVector2);\r\n\r\n        if (this.scaleSnap && this.object) {\r\n          if (axis.search('X') !== -1) {\r\n            this.object.scale.x = Math.round(object.scale.x / this.scaleSnap) * this.scaleSnap || this.scaleSnap;\r\n          }\r\n\r\n          if (axis.search('Y') !== -1) {\r\n            object.scale.y = Math.round(object.scale.y / this.scaleSnap) * this.scaleSnap || this.scaleSnap;\r\n          }\r\n\r\n          if (axis.search('Z') !== -1) {\r\n            object.scale.z = Math.round(object.scale.z / this.scaleSnap) * this.scaleSnap || this.scaleSnap;\r\n          }\r\n        }\r\n      } else if (mode === 'rotate') {\r\n        this.offset.copy(this.pointEnd).sub(this.pointStart);\r\n        const ROTATION_SPEED = 20 / this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));\r\n\r\n        if (axis === 'E') {\r\n          this.rotationAxis.copy(this.eye);\r\n          this.rotationAngle = this.pointEnd.angleTo(this.pointStart);\r\n          this.startNorm.copy(this.pointStart).normalize();\r\n          this.endNorm.copy(this.pointEnd).normalize();\r\n          this.rotationAngle *= this.endNorm.cross(this.startNorm).dot(this.eye) < 0 ? 1 : -1;\r\n        } else if (axis === 'XYZE') {\r\n          this.rotationAxis.copy(this.offset).cross(this.eye).normalize();\r\n          this.rotationAngle = this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye)) * ROTATION_SPEED;\r\n        } else if (axis === 'X' || axis === 'Y' || axis === 'Z') {\r\n          this.rotationAxis.copy(this.unit[axis]);\r\n          this.tempVector.copy(this.unit[axis]);\r\n\r\n          if (space === 'local') {\r\n            this.tempVector.applyQuaternion(this.worldQuaternion);\r\n          }\r\n\r\n          this.rotationAngle = this.offset.dot(this.tempVector.cross(this.eye).normalize()) * ROTATION_SPEED;\r\n        } // Apply rotation snap\r\n\r\n\r\n        if (this.rotationSnap) {\r\n          this.rotationAngle = Math.round(this.rotationAngle / this.rotationSnap) * this.rotationSnap;\r\n        } // Apply rotate\r\n\r\n\r\n        if (space === 'local' && axis !== 'E' && axis !== 'XYZE') {\r\n          object.quaternion.copy(this.quaternionStart);\r\n          object.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis, this.rotationAngle)).normalize();\r\n        } else {\r\n          this.rotationAxis.applyQuaternion(this.parentQuaternionInv);\r\n          object.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis, this.rotationAngle));\r\n          object.quaternion.multiply(this.quaternionStart).normalize();\r\n        }\r\n      }\r\n\r\n      this.dispatchEvent(this.changeEvent);\r\n      this.dispatchEvent(this.objectChangeEvent);\r\n    });\r\n\r\n    _defineProperty(this, \"pointerUp\", pointer => {\r\n      if (pointer.button !== 0) return;\r\n\r\n      if (this.dragging && this.axis !== null) {\r\n        this.mouseUpEvent.mode = this.mode;\r\n        this.dispatchEvent(this.mouseUpEvent);\r\n      }\r\n\r\n      this.dragging = false;\r\n      this.axis = null;\r\n    });\r\n\r\n    _defineProperty(this, \"getPointer\", event => {\r\n      var _this$domElement$owne;\r\n\r\n      if (this.domElement && (_this$domElement$owne = this.domElement.ownerDocument) !== null && _this$domElement$owne !== void 0 && _this$domElement$owne.pointerLockElement) {\r\n        return {\r\n          x: 0,\r\n          y: 0,\r\n          button: event.button\r\n        };\r\n      } else {\r\n        var _this$domElement;\r\n\r\n        const pointer = event.changedTouches ? event.changedTouches[0] : event;\r\n        const rect = (_this$domElement = this.domElement) === null || _this$domElement === void 0 ? void 0 : _this$domElement.getBoundingClientRect();\r\n        return {\r\n          x: (pointer.clientX - rect.left) / rect.width * 2 - 1,\r\n          y: -(pointer.clientY - rect.top) / rect.height * 2 + 1,\r\n          button: event.button\r\n        };\r\n      }\r\n    });\r\n\r\n    _defineProperty(this, \"onPointerHover\", event => {\r\n      if (!this.enabled) return;\r\n\r\n      switch (event.pointerType) {\r\n        case 'mouse':\r\n        case 'pen':\r\n          this.pointerHover(this.getPointer(event));\r\n          break;\r\n      }\r\n    });\r\n\r\n    _defineProperty(this, \"onPointerDown\", event => {\r\n      if (!this.enabled || !this.domElement) return;\r\n      this.domElement.style.touchAction = 'none'; // disable touch scroll\r\n\r\n      this.domElement.ownerDocument.addEventListener('pointermove', this.onPointerMove);\r\n      this.pointerHover(this.getPointer(event));\r\n      this.pointerDown(this.getPointer(event));\r\n    });\r\n\r\n    _defineProperty(this, \"onPointerMove\", event => {\r\n      if (!this.enabled) return;\r\n      this.pointerMove(this.getPointer(event));\r\n    });\r\n\r\n    _defineProperty(this, \"onPointerUp\", event => {\r\n      if (!this.enabled || !this.domElement) return;\r\n      this.domElement.style.touchAction = '';\r\n      this.domElement.ownerDocument.removeEventListener('pointermove', this.onPointerMove);\r\n      this.pointerUp(this.getPointer(event));\r\n    });\r\n\r\n    _defineProperty(this, \"getMode\", () => this.mode);\r\n\r\n    _defineProperty(this, \"setMode\", mode => {\r\n      this.mode = mode;\r\n    });\r\n\r\n    _defineProperty(this, \"setTranslationSnap\", translationSnap => {\r\n      this.translationSnap = translationSnap;\r\n    });\r\n\r\n    _defineProperty(this, \"setRotationSnap\", rotationSnap => {\r\n      this.rotationSnap = rotationSnap;\r\n    });\r\n\r\n    _defineProperty(this, \"setScaleSnap\", scaleSnap => {\r\n      this.scaleSnap = scaleSnap;\r\n    });\r\n\r\n    _defineProperty(this, \"setSize\", size => {\r\n      this.size = size;\r\n    });\r\n\r\n    _defineProperty(this, \"setSpace\", space => {\r\n      this.space = space;\r\n    });\r\n\r\n    _defineProperty(this, \"update\", () => {\r\n      console.warn('THREE.TransformControls: update function has no more functionality and therefore has been deprecated.');\r\n    });\r\n\r\n    _defineProperty(this, \"connect\", domElement => {\r\n      if (domElement === document) {\r\n        console.error('THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.');\r\n      }\r\n\r\n      this.domElement = domElement;\r\n      this.domElement.addEventListener('pointerdown', this.onPointerDown);\r\n      this.domElement.addEventListener('pointermove', this.onPointerHover);\r\n      this.domElement.ownerDocument.addEventListener('pointerup', this.onPointerUp);\r\n    });\r\n\r\n    _defineProperty(this, \"dispose\", () => {\r\n      var _this$domElement2, _this$domElement3, _this$domElement4, _this$domElement4$own, _this$domElement5, _this$domElement5$own;\r\n\r\n      (_this$domElement2 = this.domElement) === null || _this$domElement2 === void 0 ? void 0 : _this$domElement2.removeEventListener('pointerdown', this.onPointerDown);\r\n      (_this$domElement3 = this.domElement) === null || _this$domElement3 === void 0 ? void 0 : _this$domElement3.removeEventListener('pointermove', this.onPointerHover);\r\n      (_this$domElement4 = this.domElement) === null || _this$domElement4 === void 0 ? void 0 : (_this$domElement4$own = _this$domElement4.ownerDocument) === null || _this$domElement4$own === void 0 ? void 0 : _this$domElement4$own.removeEventListener('pointermove', this.onPointerMove);\r\n      (_this$domElement5 = this.domElement) === null || _this$domElement5 === void 0 ? void 0 : (_this$domElement5$own = _this$domElement5.ownerDocument) === null || _this$domElement5$own === void 0 ? void 0 : _this$domElement5$own.removeEventListener('pointerup', this.onPointerUp);\r\n      this.traverse(child => {\r\n        const mesh = child;\r\n\r\n        if (mesh.geometry) {\r\n          mesh.geometry.dispose();\r\n        }\r\n\r\n        if (mesh.material) {\r\n          mesh.material.dispose();\r\n        }\r\n      });\r\n    });\r\n\r\n    this.domElement = _domElement;\r\n    this.camera = camera;\r\n    this.gizmo = new TransformControlsGizmo();\r\n    this.add(this.gizmo);\r\n    this.plane = new TransformControlsPlane();\r\n    this.add(this.plane); // Defined getter, setter and store for a property\r\n\r\n    const defineProperty = (propName, defaultValue) => {\r\n      let propValue = defaultValue;\r\n      Object.defineProperty(this, propName, {\r\n        get: function () {\r\n          return propValue !== undefined ? propValue : defaultValue;\r\n        },\r\n        set: function (value) {\r\n          if (propValue !== value) {\r\n            propValue = value;\r\n            this.plane[propName] = value;\r\n            this.gizmo[propName] = value;\r\n            this.dispatchEvent({\r\n              type: propName + '-changed',\r\n              value: value\r\n            });\r\n            this.dispatchEvent(this.changeEvent);\r\n          }\r\n        }\r\n      }); //@ts-ignore\r\n\r\n      this[propName] = defaultValue; // @ts-ignore\r\n\r\n      this.plane[propName] = defaultValue; // @ts-ignore\r\n\r\n      this.gizmo[propName] = defaultValue;\r\n    };\r\n\r\n    defineProperty('camera', this.camera);\r\n    defineProperty('object', this.object);\r\n    defineProperty('enabled', this.enabled);\r\n    defineProperty('axis', this.axis);\r\n    defineProperty('mode', this.mode);\r\n    defineProperty('translationSnap', this.translationSnap);\r\n    defineProperty('rotationSnap', this.rotationSnap);\r\n    defineProperty('scaleSnap', this.scaleSnap);\r\n    defineProperty('space', this.space);\r\n    defineProperty('size', this.size);\r\n    defineProperty('dragging', this.dragging);\r\n    defineProperty('showX', this.showX);\r\n    defineProperty('showY', this.showY);\r\n    defineProperty('showZ', this.showZ);\r\n    defineProperty('worldPosition', this.worldPosition);\r\n    defineProperty('worldPositionStart', this.worldPositionStart);\r\n    defineProperty('worldQuaternion', this.worldQuaternion);\r\n    defineProperty('worldQuaternionStart', this.worldQuaternionStart);\r\n    defineProperty('cameraPosition', this.cameraPosition);\r\n    defineProperty('cameraQuaternion', this.cameraQuaternion);\r\n    defineProperty('pointStart', this.pointStart);\r\n    defineProperty('pointEnd', this.pointEnd);\r\n    defineProperty('rotationAxis', this.rotationAxis);\r\n    defineProperty('rotationAngle', this.rotationAngle);\r\n    defineProperty('eye', this.eye); // connect events\r\n\r\n    if (_domElement !== undefined) this.connect(_domElement);\r\n  }\r\n\r\n}\r\n\r\nclass TransformControlsGizmo extends Object3D {\r\n  // these are set from parent class TransformControls\r\n  constructor() {\r\n    super();\r\n\r\n    _defineProperty(this, \"isTransformControlsGizmo\", true);\r\n\r\n    _defineProperty(this, \"type\", 'TransformControlsGizmo');\r\n\r\n    _defineProperty(this, \"tempVector\", new Vector3(0, 0, 0));\r\n\r\n    _defineProperty(this, \"tempEuler\", new Euler());\r\n\r\n    _defineProperty(this, \"alignVector\", new Vector3(0, 1, 0));\r\n\r\n    _defineProperty(this, \"zeroVector\", new Vector3(0, 0, 0));\r\n\r\n    _defineProperty(this, \"lookAtMatrix\", new Matrix4());\r\n\r\n    _defineProperty(this, \"tempQuaternion\", new Quaternion());\r\n\r\n    _defineProperty(this, \"tempQuaternion2\", new Quaternion());\r\n\r\n    _defineProperty(this, \"identityQuaternion\", new Quaternion());\r\n\r\n    _defineProperty(this, \"unitX\", new Vector3(1, 0, 0));\r\n\r\n    _defineProperty(this, \"unitY\", new Vector3(0, 1, 0));\r\n\r\n    _defineProperty(this, \"unitZ\", new Vector3(0, 0, 1));\r\n\r\n    _defineProperty(this, \"gizmo\", void 0);\r\n\r\n    _defineProperty(this, \"picker\", void 0);\r\n\r\n    _defineProperty(this, \"helper\", void 0);\r\n\r\n    _defineProperty(this, \"rotationAxis\", new Vector3());\r\n\r\n    _defineProperty(this, \"cameraPosition\", new Vector3());\r\n\r\n    _defineProperty(this, \"worldPositionStart\", new Vector3());\r\n\r\n    _defineProperty(this, \"worldQuaternionStart\", new Quaternion());\r\n\r\n    _defineProperty(this, \"worldPosition\", new Vector3());\r\n\r\n    _defineProperty(this, \"worldQuaternion\", new Quaternion());\r\n\r\n    _defineProperty(this, \"eye\", new Vector3());\r\n\r\n    _defineProperty(this, \"camera\", null);\r\n\r\n    _defineProperty(this, \"enabled\", true);\r\n\r\n    _defineProperty(this, \"axis\", null);\r\n\r\n    _defineProperty(this, \"mode\", 'translate');\r\n\r\n    _defineProperty(this, \"space\", 'world');\r\n\r\n    _defineProperty(this, \"size\", 1);\r\n\r\n    _defineProperty(this, \"dragging\", false);\r\n\r\n    _defineProperty(this, \"showX\", true);\r\n\r\n    _defineProperty(this, \"showY\", true);\r\n\r\n    _defineProperty(this, \"showZ\", true);\r\n\r\n    _defineProperty(this, \"updateMatrixWorld\", () => {\r\n      let space = this.space;\r\n\r\n      if (this.mode === 'scale') {\r\n        space = 'local'; // scale always oriented to local rotation\r\n      }\r\n\r\n      const quaternion = space === 'local' ? this.worldQuaternion : this.identityQuaternion; // Show only gizmos for current transform mode\r\n\r\n      this.gizmo['translate'].visible = this.mode === 'translate';\r\n      this.gizmo['rotate'].visible = this.mode === 'rotate';\r\n      this.gizmo['scale'].visible = this.mode === 'scale';\r\n      this.helper['translate'].visible = this.mode === 'translate';\r\n      this.helper['rotate'].visible = this.mode === 'rotate';\r\n      this.helper['scale'].visible = this.mode === 'scale';\r\n      let handles = [];\r\n      handles = handles.concat(this.picker[this.mode].children);\r\n      handles = handles.concat(this.gizmo[this.mode].children);\r\n      handles = handles.concat(this.helper[this.mode].children);\r\n\r\n      for (let i = 0; i < handles.length; i++) {\r\n        const handle = handles[i]; // hide aligned to camera\r\n\r\n        handle.visible = true;\r\n        handle.rotation.set(0, 0, 0);\r\n        handle.position.copy(this.worldPosition);\r\n        let factor;\r\n\r\n        if (this.camera.isOrthographicCamera) {\r\n          factor = (this.camera.top - this.camera.bottom) / this.camera.zoom;\r\n        } else {\r\n          factor = this.worldPosition.distanceTo(this.cameraPosition) * Math.min(1.9 * Math.tan(Math.PI * this.camera.fov / 360) / this.camera.zoom, 7);\r\n        }\r\n\r\n        handle.scale.set(1, 1, 1).multiplyScalar(factor * this.size / 7); // TODO: simplify helpers and consider decoupling from gizmo\r\n\r\n        if (handle.tag === 'helper') {\r\n          handle.visible = false;\r\n\r\n          if (handle.name === 'AXIS') {\r\n            handle.position.copy(this.worldPositionStart);\r\n            handle.visible = !!this.axis;\r\n\r\n            if (this.axis === 'X') {\r\n              this.tempQuaternion.setFromEuler(this.tempEuler.set(0, 0, 0));\r\n              handle.quaternion.copy(quaternion).multiply(this.tempQuaternion);\r\n\r\n              if (Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\r\n                handle.visible = false;\r\n              }\r\n            }\r\n\r\n            if (this.axis === 'Y') {\r\n              this.tempQuaternion.setFromEuler(this.tempEuler.set(0, 0, Math.PI / 2));\r\n              handle.quaternion.copy(quaternion).multiply(this.tempQuaternion);\r\n\r\n              if (Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\r\n                handle.visible = false;\r\n              }\r\n            }\r\n\r\n            if (this.axis === 'Z') {\r\n              this.tempQuaternion.setFromEuler(this.tempEuler.set(0, Math.PI / 2, 0));\r\n              handle.quaternion.copy(quaternion).multiply(this.tempQuaternion);\r\n\r\n              if (Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\r\n                handle.visible = false;\r\n              }\r\n            }\r\n\r\n            if (this.axis === 'XYZE') {\r\n              this.tempQuaternion.setFromEuler(this.tempEuler.set(0, Math.PI / 2, 0));\r\n              this.alignVector.copy(this.rotationAxis);\r\n              handle.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector, this.alignVector, this.unitY));\r\n              handle.quaternion.multiply(this.tempQuaternion);\r\n              handle.visible = this.dragging;\r\n            }\r\n\r\n            if (this.axis === 'E') {\r\n              handle.visible = false;\r\n            }\r\n          } else if (handle.name === 'START') {\r\n            handle.position.copy(this.worldPositionStart);\r\n            handle.visible = this.dragging;\r\n          } else if (handle.name === 'END') {\r\n            handle.position.copy(this.worldPosition);\r\n            handle.visible = this.dragging;\r\n          } else if (handle.name === 'DELTA') {\r\n            handle.position.copy(this.worldPositionStart);\r\n            handle.quaternion.copy(this.worldQuaternionStart);\r\n            this.tempVector.set(1e-10, 1e-10, 1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1);\r\n            this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert());\r\n            handle.scale.copy(this.tempVector);\r\n            handle.visible = this.dragging;\r\n          } else {\r\n            handle.quaternion.copy(quaternion);\r\n\r\n            if (this.dragging) {\r\n              handle.position.copy(this.worldPositionStart);\r\n            } else {\r\n              handle.position.copy(this.worldPosition);\r\n            }\r\n\r\n            if (this.axis) {\r\n              handle.visible = this.axis.search(handle.name) !== -1;\r\n            }\r\n          } // If updating helper, skip rest of the loop\r\n\r\n\r\n          continue;\r\n        } // Align handles to current local or world rotation\r\n\r\n\r\n        handle.quaternion.copy(quaternion);\r\n\r\n        if (this.mode === 'translate' || this.mode === 'scale') {\r\n          // Hide translate and scale axis facing the camera\r\n          const AXIS_HIDE_TRESHOLD = 0.99;\r\n          const PLANE_HIDE_TRESHOLD = 0.2;\r\n          const AXIS_FLIP_TRESHOLD = 0.0;\r\n\r\n          if (handle.name === 'X' || handle.name === 'XYZX') {\r\n            if (Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\r\n              handle.scale.set(1e-10, 1e-10, 1e-10);\r\n              handle.visible = false;\r\n            }\r\n          }\r\n\r\n          if (handle.name === 'Y' || handle.name === 'XYZY') {\r\n            if (Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\r\n              handle.scale.set(1e-10, 1e-10, 1e-10);\r\n              handle.visible = false;\r\n            }\r\n          }\r\n\r\n          if (handle.name === 'Z' || handle.name === 'XYZZ') {\r\n            if (Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\r\n              handle.scale.set(1e-10, 1e-10, 1e-10);\r\n              handle.visible = false;\r\n            }\r\n          }\r\n\r\n          if (handle.name === 'XY') {\r\n            if (Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\r\n              handle.scale.set(1e-10, 1e-10, 1e-10);\r\n              handle.visible = false;\r\n            }\r\n          }\r\n\r\n          if (handle.name === 'YZ') {\r\n            if (Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\r\n              handle.scale.set(1e-10, 1e-10, 1e-10);\r\n              handle.visible = false;\r\n            }\r\n          }\r\n\r\n          if (handle.name === 'XZ') {\r\n            if (Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\r\n              handle.scale.set(1e-10, 1e-10, 1e-10);\r\n              handle.visible = false;\r\n            }\r\n          } // Flip translate and scale axis ocluded behind another axis\r\n\r\n\r\n          if (handle.name.search('X') !== -1) {\r\n            if (this.alignVector.copy(this.unitX).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\r\n              if (handle.tag === 'fwd') {\r\n                handle.visible = false;\r\n              } else {\r\n                handle.scale.x *= -1;\r\n              }\r\n            } else if (handle.tag === 'bwd') {\r\n              handle.visible = false;\r\n            }\r\n          }\r\n\r\n          if (handle.name.search('Y') !== -1) {\r\n            if (this.alignVector.copy(this.unitY).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\r\n              if (handle.tag === 'fwd') {\r\n                handle.visible = false;\r\n              } else {\r\n                handle.scale.y *= -1;\r\n              }\r\n            } else if (handle.tag === 'bwd') {\r\n              handle.visible = false;\r\n            }\r\n          }\r\n\r\n          if (handle.name.search('Z') !== -1) {\r\n            if (this.alignVector.copy(this.unitZ).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\r\n              if (handle.tag === 'fwd') {\r\n                handle.visible = false;\r\n              } else {\r\n                handle.scale.z *= -1;\r\n              }\r\n            } else if (handle.tag === 'bwd') {\r\n              handle.visible = false;\r\n            }\r\n          }\r\n        } else if (this.mode === 'rotate') {\r\n          // Align handles to current local or world rotation\r\n          this.tempQuaternion2.copy(quaternion);\r\n          this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(quaternion).invert());\r\n\r\n          if (handle.name.search('E') !== -1) {\r\n            handle.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye, this.zeroVector, this.unitY));\r\n          }\r\n\r\n          if (handle.name === 'X') {\r\n            this.tempQuaternion.setFromAxisAngle(this.unitX, Math.atan2(-this.alignVector.y, this.alignVector.z));\r\n            this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2, this.tempQuaternion);\r\n            handle.quaternion.copy(this.tempQuaternion);\r\n          }\r\n\r\n          if (handle.name === 'Y') {\r\n            this.tempQuaternion.setFromAxisAngle(this.unitY, Math.atan2(this.alignVector.x, this.alignVector.z));\r\n            this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2, this.tempQuaternion);\r\n            handle.quaternion.copy(this.tempQuaternion);\r\n          }\r\n\r\n          if (handle.name === 'Z') {\r\n            this.tempQuaternion.setFromAxisAngle(this.unitZ, Math.atan2(this.alignVector.y, this.alignVector.x));\r\n            this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2, this.tempQuaternion);\r\n            handle.quaternion.copy(this.tempQuaternion);\r\n          }\r\n        } // Hide disabled axes\r\n\r\n\r\n        handle.visible = handle.visible && (handle.name.indexOf('X') === -1 || this.showX);\r\n        handle.visible = handle.visible && (handle.name.indexOf('Y') === -1 || this.showY);\r\n        handle.visible = handle.visible && (handle.name.indexOf('Z') === -1 || this.showZ);\r\n        handle.visible = handle.visible && (handle.name.indexOf('E') === -1 || this.showX && this.showY && this.showZ); // highlight selected axis\r\n        //@ts-ignore\r\n\r\n        handle.material.tempOpacity = handle.material.tempOpacity || handle.material.opacity; //@ts-ignore\r\n\r\n        handle.material.tempColor = handle.material.tempColor || handle.material.color.clone(); //@ts-ignore\r\n\r\n        handle.material.color.copy(handle.material.tempColor); //@ts-ignore\r\n\r\n        handle.material.opacity = handle.material.tempOpacity;\r\n\r\n        if (!this.enabled) {\r\n          //@ts-ignore\r\n          handle.material.opacity *= 0.5; //@ts-ignore\r\n\r\n          handle.material.color.lerp(new Color(1, 1, 1), 0.5);\r\n        } else if (this.axis) {\r\n          if (handle.name === this.axis) {\r\n            //@ts-ignore\r\n            handle.material.opacity = 1.0; //@ts-ignore\r\n\r\n            handle.material.color.lerp(new Color(1, 1, 1), 0.5);\r\n          } else if (this.axis.split('').some(function (a) {\r\n            return handle.name === a;\r\n          })) {\r\n            //@ts-ignore\r\n            handle.material.opacity = 1.0; //@ts-ignore\r\n\r\n            handle.material.color.lerp(new Color(1, 1, 1), 0.5);\r\n          } else {\r\n            //@ts-ignore\r\n            handle.material.opacity *= 0.25; //@ts-ignore\r\n\r\n            handle.material.color.lerp(new Color(1, 1, 1), 0.5);\r\n          }\r\n        }\r\n      }\r\n\r\n      super.updateMatrixWorld();\r\n    });\r\n\r\n    const gizmoMaterial = new MeshBasicMaterial({\r\n      depthTest: false,\r\n      depthWrite: false,\r\n      transparent: true,\r\n      side: DoubleSide,\r\n      fog: false,\r\n      toneMapped: false\r\n    });\r\n    const gizmoLineMaterial = new LineBasicMaterial({\r\n      depthTest: false,\r\n      depthWrite: false,\r\n      transparent: true,\r\n      linewidth: 1,\r\n      fog: false,\r\n      toneMapped: false\r\n    }); // Make unique material for each axis/color\r\n\r\n    const matInvisible = gizmoMaterial.clone();\r\n    matInvisible.opacity = 0.15;\r\n    const matHelper = gizmoMaterial.clone();\r\n    matHelper.opacity = 0.33;\r\n    const matRed = gizmoMaterial.clone();\r\n    matRed.color.set(0xff0000);\r\n    const matGreen = gizmoMaterial.clone();\r\n    matGreen.color.set(0x00ff00);\r\n    const matBlue = gizmoMaterial.clone();\r\n    matBlue.color.set(0x0000ff);\r\n    const matWhiteTransparent = gizmoMaterial.clone();\r\n    matWhiteTransparent.opacity = 0.25;\r\n    const matYellowTransparent = matWhiteTransparent.clone();\r\n    matYellowTransparent.color.set(0xffff00);\r\n    const matCyanTransparent = matWhiteTransparent.clone();\r\n    matCyanTransparent.color.set(0x00ffff);\r\n    const matMagentaTransparent = matWhiteTransparent.clone();\r\n    matMagentaTransparent.color.set(0xff00ff);\r\n    const matYellow = gizmoMaterial.clone();\r\n    matYellow.color.set(0xffff00);\r\n    const matLineRed = gizmoLineMaterial.clone();\r\n    matLineRed.color.set(0xff0000);\r\n    const matLineGreen = gizmoLineMaterial.clone();\r\n    matLineGreen.color.set(0x00ff00);\r\n    const matLineBlue = gizmoLineMaterial.clone();\r\n    matLineBlue.color.set(0x0000ff);\r\n    const matLineCyan = gizmoLineMaterial.clone();\r\n    matLineCyan.color.set(0x00ffff);\r\n    const matLineMagenta = gizmoLineMaterial.clone();\r\n    matLineMagenta.color.set(0xff00ff);\r\n    const matLineYellow = gizmoLineMaterial.clone();\r\n    matLineYellow.color.set(0xffff00);\r\n    const matLineGray = gizmoLineMaterial.clone();\r\n    matLineGray.color.set(0x787878);\r\n    const matLineYellowTransparent = matLineYellow.clone();\r\n    matLineYellowTransparent.opacity = 0.25; // reusable geometry\r\n\r\n    const arrowGeometry = new CylinderGeometry(0, 0.05, 0.2, 12, 1, false);\r\n    const scaleHandleGeometry = new BoxGeometry(0.125, 0.125, 0.125);\r\n    const lineGeometry = new BufferGeometry();\r\n    lineGeometry.setAttribute('position', new Float32BufferAttribute([0, 0, 0, 1, 0, 0], 3));\r\n\r\n    const CircleGeometry = (radius, arc) => {\r\n      const geometry = new BufferGeometry();\r\n      const vertices = [];\r\n\r\n      for (let i = 0; i <= 64 * arc; ++i) {\r\n        vertices.push(0, Math.cos(i / 32 * Math.PI) * radius, Math.sin(i / 32 * Math.PI) * radius);\r\n      }\r\n\r\n      geometry.setAttribute('position', new Float32BufferAttribute(vertices, 3));\r\n      return geometry;\r\n    }; // Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\r\n\r\n\r\n    const TranslateHelperGeometry = () => {\r\n      const geometry = new BufferGeometry();\r\n      geometry.setAttribute('position', new Float32BufferAttribute([0, 0, 0, 1, 1, 1], 3));\r\n      return geometry;\r\n    }; // Gizmo definitions - custom hierarchy definitions for setupGizmo() function\r\n\r\n\r\n    const gizmoTranslate = {\r\n      X: [[new Mesh(arrowGeometry, matRed), [1, 0, 0], [0, 0, -Math.PI / 2], null, 'fwd'], [new Mesh(arrowGeometry, matRed), [1, 0, 0], [0, 0, Math.PI / 2], null, 'bwd'], [new Line(lineGeometry, matLineRed)]],\r\n      Y: [[new Mesh(arrowGeometry, matGreen), [0, 1, 0], null, null, 'fwd'], [new Mesh(arrowGeometry, matGreen), [0, 1, 0], [Math.PI, 0, 0], null, 'bwd'], [new Line(lineGeometry, matLineGreen), null, [0, 0, Math.PI / 2]]],\r\n      Z: [[new Mesh(arrowGeometry, matBlue), [0, 0, 1], [Math.PI / 2, 0, 0], null, 'fwd'], [new Mesh(arrowGeometry, matBlue), [0, 0, 1], [-Math.PI / 2, 0, 0], null, 'bwd'], [new Line(lineGeometry, matLineBlue), null, [0, -Math.PI / 2, 0]]],\r\n      XYZ: [[new Mesh(new OctahedronGeometry(0.1, 0), matWhiteTransparent.clone()), [0, 0, 0], [0, 0, 0]]],\r\n      XY: [[new Mesh(new PlaneGeometry(0.295, 0.295), matYellowTransparent.clone()), [0.15, 0.15, 0]], [new Line(lineGeometry, matLineYellow), [0.18, 0.3, 0], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineYellow), [0.3, 0.18, 0], [0, 0, Math.PI / 2], [0.125, 1, 1]]],\r\n      YZ: [[new Mesh(new PlaneGeometry(0.295, 0.295), matCyanTransparent.clone()), [0, 0.15, 0.15], [0, Math.PI / 2, 0]], [new Line(lineGeometry, matLineCyan), [0, 0.18, 0.3], [0, 0, Math.PI / 2], [0.125, 1, 1]], [new Line(lineGeometry, matLineCyan), [0, 0.3, 0.18], [0, -Math.PI / 2, 0], [0.125, 1, 1]]],\r\n      XZ: [[new Mesh(new PlaneGeometry(0.295, 0.295), matMagentaTransparent.clone()), [0.15, 0, 0.15], [-Math.PI / 2, 0, 0]], [new Line(lineGeometry, matLineMagenta), [0.18, 0, 0.3], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineMagenta), [0.3, 0, 0.18], [0, -Math.PI / 2, 0], [0.125, 1, 1]]]\r\n    };\r\n    const pickerTranslate = {\r\n      X: [[new Mesh(new CylinderGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0.6, 0, 0], [0, 0, -Math.PI / 2]]],\r\n      Y: [[new Mesh(new CylinderGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0, 0.6, 0]]],\r\n      Z: [[new Mesh(new CylinderGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0, 0, 0.6], [Math.PI / 2, 0, 0]]],\r\n      XYZ: [[new Mesh(new OctahedronGeometry(0.2, 0), matInvisible)]],\r\n      XY: [[new Mesh(new PlaneGeometry(0.4, 0.4), matInvisible), [0.2, 0.2, 0]]],\r\n      YZ: [[new Mesh(new PlaneGeometry(0.4, 0.4), matInvisible), [0, 0.2, 0.2], [0, Math.PI / 2, 0]]],\r\n      XZ: [[new Mesh(new PlaneGeometry(0.4, 0.4), matInvisible), [0.2, 0, 0.2], [-Math.PI / 2, 0, 0]]]\r\n    };\r\n    const helperTranslate = {\r\n      START: [[new Mesh(new OctahedronGeometry(0.01, 2), matHelper), null, null, null, 'helper']],\r\n      END: [[new Mesh(new OctahedronGeometry(0.01, 2), matHelper), null, null, null, 'helper']],\r\n      DELTA: [[new Line(TranslateHelperGeometry(), matHelper), null, null, null, 'helper']],\r\n      X: [[new Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], 'helper']],\r\n      Y: [[new Line(lineGeometry, matHelper.clone()), [0, -1e3, 0], [0, 0, Math.PI / 2], [1e6, 1, 1], 'helper']],\r\n      Z: [[new Line(lineGeometry, matHelper.clone()), [0, 0, -1e3], [0, -Math.PI / 2, 0], [1e6, 1, 1], 'helper']]\r\n    };\r\n    const gizmoRotate = {\r\n      X: [[new Line(CircleGeometry(1, 0.5), matLineRed)], [new Mesh(new OctahedronGeometry(0.04, 0), matRed), [0, 0, 0.99], null, [1, 3, 1]]],\r\n      Y: [[new Line(CircleGeometry(1, 0.5), matLineGreen), null, [0, 0, -Math.PI / 2]], [new Mesh(new OctahedronGeometry(0.04, 0), matGreen), [0, 0, 0.99], null, [3, 1, 1]]],\r\n      Z: [[new Line(CircleGeometry(1, 0.5), matLineBlue), null, [0, Math.PI / 2, 0]], [new Mesh(new OctahedronGeometry(0.04, 0), matBlue), [0.99, 0, 0], null, [1, 3, 1]]],\r\n      E: [[new Line(CircleGeometry(1.25, 1), matLineYellowTransparent), null, [0, Math.PI / 2, 0]], [new Mesh(new CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [1.17, 0, 0], [0, 0, -Math.PI / 2], [1, 1, 0.001]], [new Mesh(new CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [-1.17, 0, 0], [0, 0, Math.PI / 2], [1, 1, 0.001]], [new Mesh(new CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [0, -1.17, 0], [Math.PI, 0, 0], [1, 1, 0.001]], [new Mesh(new CylinderGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [0, 1.17, 0], [0, 0, 0], [1, 1, 0.001]]],\r\n      XYZE: [[new Line(CircleGeometry(1, 1), matLineGray), null, [0, Math.PI / 2, 0]]]\r\n    };\r\n    const helperRotate = {\r\n      AXIS: [[new Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], 'helper']]\r\n    };\r\n    const pickerRotate = {\r\n      X: [[new Mesh(new TorusGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [0, -Math.PI / 2, -Math.PI / 2]]],\r\n      Y: [[new Mesh(new TorusGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [Math.PI / 2, 0, 0]]],\r\n      Z: [[new Mesh(new TorusGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [0, 0, -Math.PI / 2]]],\r\n      E: [[new Mesh(new TorusGeometry(1.25, 0.1, 2, 24), matInvisible)]],\r\n      XYZE: [[new Mesh(new SphereGeometry(0.7, 10, 8), matInvisible)]]\r\n    };\r\n    const gizmoScale = {\r\n      X: [[new Mesh(scaleHandleGeometry, matRed), [0.8, 0, 0], [0, 0, -Math.PI / 2]], [new Line(lineGeometry, matLineRed), null, null, [0.8, 1, 1]]],\r\n      Y: [[new Mesh(scaleHandleGeometry, matGreen), [0, 0.8, 0]], [new Line(lineGeometry, matLineGreen), null, [0, 0, Math.PI / 2], [0.8, 1, 1]]],\r\n      Z: [[new Mesh(scaleHandleGeometry, matBlue), [0, 0, 0.8], [Math.PI / 2, 0, 0]], [new Line(lineGeometry, matLineBlue), null, [0, -Math.PI / 2, 0], [0.8, 1, 1]]],\r\n      XY: [[new Mesh(scaleHandleGeometry, matYellowTransparent), [0.85, 0.85, 0], null, [2, 2, 0.2]], [new Line(lineGeometry, matLineYellow), [0.855, 0.98, 0], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineYellow), [0.98, 0.855, 0], [0, 0, Math.PI / 2], [0.125, 1, 1]]],\r\n      YZ: [[new Mesh(scaleHandleGeometry, matCyanTransparent), [0, 0.85, 0.85], null, [0.2, 2, 2]], [new Line(lineGeometry, matLineCyan), [0, 0.855, 0.98], [0, 0, Math.PI / 2], [0.125, 1, 1]], [new Line(lineGeometry, matLineCyan), [0, 0.98, 0.855], [0, -Math.PI / 2, 0], [0.125, 1, 1]]],\r\n      XZ: [[new Mesh(scaleHandleGeometry, matMagentaTransparent), [0.85, 0, 0.85], null, [2, 0.2, 2]], [new Line(lineGeometry, matLineMagenta), [0.855, 0, 0.98], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineMagenta), [0.98, 0, 0.855], [0, -Math.PI / 2, 0], [0.125, 1, 1]]],\r\n      XYZX: [[new Mesh(new BoxGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [1.1, 0, 0]]],\r\n      XYZY: [[new Mesh(new BoxGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [0, 1.1, 0]]],\r\n      XYZZ: [[new Mesh(new BoxGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [0, 0, 1.1]]]\r\n    };\r\n    const pickerScale = {\r\n      X: [[new Mesh(new CylinderGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0.5, 0, 0], [0, 0, -Math.PI / 2]]],\r\n      Y: [[new Mesh(new CylinderGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0, 0.5, 0]]],\r\n      Z: [[new Mesh(new CylinderGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0, 0, 0.5], [Math.PI / 2, 0, 0]]],\r\n      XY: [[new Mesh(scaleHandleGeometry, matInvisible), [0.85, 0.85, 0], null, [3, 3, 0.2]]],\r\n      YZ: [[new Mesh(scaleHandleGeometry, matInvisible), [0, 0.85, 0.85], null, [0.2, 3, 3]]],\r\n      XZ: [[new Mesh(scaleHandleGeometry, matInvisible), [0.85, 0, 0.85], null, [3, 0.2, 3]]],\r\n      XYZX: [[new Mesh(new BoxGeometry(0.2, 0.2, 0.2), matInvisible), [1.1, 0, 0]]],\r\n      XYZY: [[new Mesh(new BoxGeometry(0.2, 0.2, 0.2), matInvisible), [0, 1.1, 0]]],\r\n      XYZZ: [[new Mesh(new BoxGeometry(0.2, 0.2, 0.2), matInvisible), [0, 0, 1.1]]]\r\n    };\r\n    const helperScale = {\r\n      X: [[new Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], 'helper']],\r\n      Y: [[new Line(lineGeometry, matHelper.clone()), [0, -1e3, 0], [0, 0, Math.PI / 2], [1e6, 1, 1], 'helper']],\r\n      Z: [[new Line(lineGeometry, matHelper.clone()), [0, 0, -1e3], [0, -Math.PI / 2, 0], [1e6, 1, 1], 'helper']]\r\n    }; // Creates an Object3D with gizmos described in custom hierarchy definition.\r\n    // this is nearly impossible to Type so i'm leaving it\r\n\r\n    const setupGizmo = gizmoMap => {\r\n      const gizmo = new Object3D();\r\n\r\n      for (let name in gizmoMap) {\r\n        for (let i = gizmoMap[name].length; i--;) {\r\n          const object = gizmoMap[name][i][0].clone();\r\n          const position = gizmoMap[name][i][1];\r\n          const rotation = gizmoMap[name][i][2];\r\n          const scale = gizmoMap[name][i][3];\r\n          const tag = gizmoMap[name][i][4]; // name and tag properties are essential for picking and updating logic.\r\n\r\n          object.name = name; // @ts-ignore\r\n\r\n          object.tag = tag;\r\n\r\n          if (position) {\r\n            object.position.set(position[0], position[1], position[2]);\r\n          }\r\n\r\n          if (rotation) {\r\n            object.rotation.set(rotation[0], rotation[1], rotation[2]);\r\n          }\r\n\r\n          if (scale) {\r\n            object.scale.set(scale[0], scale[1], scale[2]);\r\n          }\r\n\r\n          object.updateMatrix();\r\n          const tempGeometry = object.geometry.clone();\r\n          tempGeometry.applyMatrix4(object.matrix);\r\n          object.geometry = tempGeometry;\r\n          object.renderOrder = Infinity;\r\n          object.position.set(0, 0, 0);\r\n          object.rotation.set(0, 0, 0);\r\n          object.scale.set(1, 1, 1);\r\n          gizmo.add(object);\r\n        }\r\n      }\r\n\r\n      return gizmo;\r\n    };\r\n\r\n    this.gizmo = {};\r\n    this.picker = {};\r\n    this.helper = {};\r\n    this.add(this.gizmo['translate'] = setupGizmo(gizmoTranslate));\r\n    this.add(this.gizmo['rotate'] = setupGizmo(gizmoRotate));\r\n    this.add(this.gizmo['scale'] = setupGizmo(gizmoScale));\r\n    this.add(this.picker['translate'] = setupGizmo(pickerTranslate));\r\n    this.add(this.picker['rotate'] = setupGizmo(pickerRotate));\r\n    this.add(this.picker['scale'] = setupGizmo(pickerScale));\r\n    this.add(this.helper['translate'] = setupGizmo(helperTranslate));\r\n    this.add(this.helper['rotate'] = setupGizmo(helperRotate));\r\n    this.add(this.helper['scale'] = setupGizmo(helperScale)); // Pickers should be hidden always\r\n\r\n    this.picker['translate'].visible = false;\r\n    this.picker['rotate'].visible = false;\r\n    this.picker['scale'].visible = false;\r\n  } // updateMatrixWorld will update transformations and appearance of individual handles\r\n\r\n\r\n}\r\n\r\nclass TransformControlsPlane extends Mesh {\r\n  constructor() {\r\n    super(new PlaneGeometry(100000, 100000, 2, 2), new MeshBasicMaterial({\r\n      visible: false,\r\n      wireframe: true,\r\n      side: DoubleSide,\r\n      transparent: true,\r\n      opacity: 0.1,\r\n      toneMapped: false\r\n    }));\r\n\r\n    _defineProperty(this, \"isTransformControlsPlane\", true);\r\n\r\n    _defineProperty(this, \"type\", 'TransformControlsPlane');\r\n\r\n    _defineProperty(this, \"unitX\", new Vector3(1, 0, 0));\r\n\r\n    _defineProperty(this, \"unitY\", new Vector3(0, 1, 0));\r\n\r\n    _defineProperty(this, \"unitZ\", new Vector3(0, 0, 1));\r\n\r\n    _defineProperty(this, \"tempVector\", new Vector3());\r\n\r\n    _defineProperty(this, \"dirVector\", new Vector3());\r\n\r\n    _defineProperty(this, \"alignVector\", new Vector3());\r\n\r\n    _defineProperty(this, \"tempMatrix\", new Matrix4());\r\n\r\n    _defineProperty(this, \"identityQuaternion\", new Quaternion());\r\n\r\n    _defineProperty(this, \"cameraQuaternion\", new Quaternion());\r\n\r\n    _defineProperty(this, \"worldPosition\", new Vector3());\r\n\r\n    _defineProperty(this, \"worldQuaternion\", new Quaternion());\r\n\r\n    _defineProperty(this, \"eye\", new Vector3());\r\n\r\n    _defineProperty(this, \"axis\", null);\r\n\r\n    _defineProperty(this, \"mode\", 'translate');\r\n\r\n    _defineProperty(this, \"space\", 'world');\r\n\r\n    _defineProperty(this, \"updateMatrixWorld\", () => {\r\n      let space = this.space;\r\n      this.position.copy(this.worldPosition);\r\n      if (this.mode === 'scale') space = 'local'; // scale always oriented to local rotation\r\n\r\n      this.unitX.set(1, 0, 0).applyQuaternion(space === 'local' ? this.worldQuaternion : this.identityQuaternion);\r\n      this.unitY.set(0, 1, 0).applyQuaternion(space === 'local' ? this.worldQuaternion : this.identityQuaternion);\r\n      this.unitZ.set(0, 0, 1).applyQuaternion(space === 'local' ? this.worldQuaternion : this.identityQuaternion); // Align the plane for current transform mode, axis and space.\r\n\r\n      this.alignVector.copy(this.unitY);\r\n\r\n      switch (this.mode) {\r\n        case 'translate':\r\n        case 'scale':\r\n          switch (this.axis) {\r\n            case 'X':\r\n              this.alignVector.copy(this.eye).cross(this.unitX);\r\n              this.dirVector.copy(this.unitX).cross(this.alignVector);\r\n              break;\r\n\r\n            case 'Y':\r\n              this.alignVector.copy(this.eye).cross(this.unitY);\r\n              this.dirVector.copy(this.unitY).cross(this.alignVector);\r\n              break;\r\n\r\n            case 'Z':\r\n              this.alignVector.copy(this.eye).cross(this.unitZ);\r\n              this.dirVector.copy(this.unitZ).cross(this.alignVector);\r\n              break;\r\n\r\n            case 'XY':\r\n              this.dirVector.copy(this.unitZ);\r\n              break;\r\n\r\n            case 'YZ':\r\n              this.dirVector.copy(this.unitX);\r\n              break;\r\n\r\n            case 'XZ':\r\n              this.alignVector.copy(this.unitZ);\r\n              this.dirVector.copy(this.unitY);\r\n              break;\r\n\r\n            case 'XYZ':\r\n            case 'E':\r\n              this.dirVector.set(0, 0, 0);\r\n              break;\r\n          }\r\n\r\n          break;\r\n\r\n        case 'rotate':\r\n        default:\r\n          // special case for rotate\r\n          this.dirVector.set(0, 0, 0);\r\n      }\r\n\r\n      if (this.dirVector.length() === 0) {\r\n        // If in rotate mode, make the plane parallel to camera\r\n        this.quaternion.copy(this.cameraQuaternion);\r\n      } else {\r\n        this.tempMatrix.lookAt(this.tempVector.set(0, 0, 0), this.dirVector, this.alignVector);\r\n        this.quaternion.setFromRotationMatrix(this.tempMatrix);\r\n      }\r\n\r\n      super.updateMatrixWorld();\r\n    });\r\n  }\r\n\r\n}\r\n\r\nexport { TransformControls, TransformControlsGizmo, TransformControlsPlane };\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}